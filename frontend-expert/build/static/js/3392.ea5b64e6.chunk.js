"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[3392],{3392:(e,l,t)=>{t.r(l),t.d(l,{default:()=>y});var s=t(89379),i=t(9950),o=t(17340),r=t(68873),a=t(6604),d=t(90004),n=t(31222),c=t(43302),x=t(37500),m=t(28429),u=t(26910),f=t(99163),v=t(28504),p=t(36008),h=t(58644),g=t(35887),j=t(44414);const N=["Profile","Reviews"];function y(){var e,l,d;const[y,D]=(0,i.useState)(0),{slug:E}=(0,m.g)(),I=(0,m.zy)(),[k,C]=(0,i.useState)(!1),P=(0,i.useRef)(null),S=null===E||void 0===E?void 0:E.slice(-24),A=(0,m.Zp)(),[R,O]=(0,i.useState)(!0),{doctor:M}=(0,v.S)(),[_,W]=(0,i.useState)(null),[z,q]=(0,i.useState)(!1),[G,F]=(0,i.useState)(!1),L=_||M,B=(0,p.sA)(L),T="/registerPersonalDetail"===I.pathname,Q=e=>{var l,t,s,i,o,r,a,d;if(!e)return null;const n=[e.doctorImage,null===(l=e.docRefId)||void 0===l?void 0:l.doctorImage,null===(t=e.personalDetails)||void 0===t?void 0:t.doctorImage,e.image,null===(s=e.docRefId)||void 0===s?void 0:s.image,null===(i=e.personalDetails)||void 0===i?void 0:i.image,e.profileImage,e.avatar,e.profilePicture,null===(o=e.userId)||void 0===o?void 0:o.doctorImage,null===(r=e.userId)||void 0===r?void 0:r.image,null===(a=e.doctor)||void 0===a?void 0:a.doctorImage,null===(d=e.doctor)||void 0===d?void 0:d.image];for(const c of n)if(c&&"string"===typeof c&&""!==c.trim()&&"undefined"!==c)return c;return null};let U;if(M&&(M._id===S||_&&M._id===_._id)){const e=Q(M),l=Q(_);U=e||l||t(1749)}else{const e=Q(_),l=Q(M);U=e||l||t(1749)}(0,i.useEffect)(()=>{(async()=>{if(S)try{O(!0);const i=await u.A.get("".concat("","/doctor/getDoctorProfile/").concat(S));if(i.data&&i.data.data){const o=i.data.data,r=Q(o),a=M?Q(M):null;if(M&&(M._id===S||M._id===o._id)){var e,l,t;const i=(0,s.A)((0,s.A)({},o),{},{doctorImage:a||r||(null===(e=o.docRefId)||void 0===e?void 0:e.doctorImage)||null,isProfileComplete:M.isProfileComplete||o.isProfileComplete,isProfileCompleted:M.isProfileCompleted||o.isProfileCompleted,hprRegistrationStatus:M.hprRegistrationStatus||o.hprRegistrationStatus,docRefId:(0,s.A)((0,s.A)({},o.docRefId||{}),{},{doctorImage:a||(null===(l=o.docRefId)||void 0===l?void 0:l.doctorImage)||null}),personalDetails:(0,s.A)((0,s.A)({},o.personalDetails||{}),{},{doctorImage:a||(null===(t=o.personalDetails)||void 0===t?void 0:t.doctorImage)||null})});W(i)}else W(o)}else M||console.error("No doctor data available")}catch(i){console.error("Error fetching profile:",i),M||console.error("Failed to load doctor profile")}finally{O(!1)}else O(!1)})()},[S,null===M||void 0===M?void 0:M._id]);return R?(0,j.jsx)(o.A,{children:(0,j.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,j.jsx)("p",{className:"text-gray-500",children:"Loading doctor profile..."})})}):L?(0,j.jsx)(o.A,{children:(0,j.jsxs)("div",{className:"flex w-full flex-col rounded-xl",children:[(0,j.jsxs)("div",{className:"flex w-full flex-col items-center bg-white md:flex-row pt-3 mt-3 p-3 pl-1 pr-3 pb-4 shadow-md",children:[(0,j.jsx)("img",{src:U,alt:"user",className:"h-[150px] w-[150px] rounded-full object-cover border border-gray-200",onError:e=>{const l=t(1749);e.target.src!==l&&(e.target.src=l)}},"doctor-image-".concat(U,"-").concat(null===L||void 0===L?void 0:L._id)),(0,j.jsxs)("div",{className:"ml-6 flex flex-col",children:[(0,j.jsxs)("div",{className:"flex items-center",children:[(0,j.jsxs)("span",{className:"text-[35px] text-[Gilroy-SemiBold] font-semibold text-gray-800",children:["Dr. ",(null===L||void 0===L?void 0:L.fullName)||(null===L||void 0===L||null===(e=L.personalDetails)||void 0===e?void 0:e.fullName)||"Doctor"]}),100===B?(0,j.jsxs)("div",{className:"relative ml-3 mt-1",onMouseEnter:()=>q(!0),onMouseLeave:()=>q(!1),children:[(0,j.jsx)(n._IM,{className:"text-[#0095D9] text-2xl cursor-pointer"}),z&&(0,j.jsx)("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-gray-800 text-white text-xs rounded whitespace-nowrap z-50",children:"Completed"})]}):T?(0,j.jsx)("div",{className:"relative ml-3 mt-1",children:(0,j.jsx)(x.A,{percentage:B})}):null!==L&&void 0!==L&&L.isProfileComplete||null!==L&&void 0!==L&&L.hprRegistrationStatus?(0,j.jsxs)("div",{className:"relative ml-2",onMouseEnter:()=>F(!0),onMouseLeave:()=>F(!1),children:[(0,j.jsx)(c.w_X,{className:"text-orange-500 text-xl cursor-pointer"}),G&&(0,j.jsx)("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-gray-800 text-white text-xs rounded whitespace-nowrap z-50",children:"Pending"})]}):(0,j.jsx)("div",{className:"relative ml-3 mt-1",children:(0,j.jsx)(x.A,{percentage:B})})]}),(0,j.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,j.jsxs)("span",{className:"text-[20px] text-[#5D5D5D] text-[Gilroy-SemiBold]",children:["Doctor ID: ",(null===L||void 0===L?void 0:L._id)||(null===L||void 0===L?void 0:L.doctorId)||"N/A"]}),(0,j.jsxs)("span",{className:"text-[20px] text-[#5D5D5D] text-[Gilroy-SemiBold]",children:["Specialization: ",Array.isArray(null===L||void 0===L||null===(l=L.systemOfMedicine)||void 0===l?void 0:l.systemOfMedicine)?L.systemOfMedicine.systemOfMedicine.join(", "):(null===L||void 0===L||null===(d=L.systemOfMedicine)||void 0===d?void 0:d.systemOfMedicine)||(null===L||void 0===L?void 0:L.specialization)||"Not specified"]})]}),(0,j.jsx)("div",{className:"mt-4 flex flex-col items-start",children:(0,j.jsxs)("div",{className:"flex flex-row",children:[M&&(M._id===S||M._id===(null===L||void 0===L?void 0:L._id))&&(0,j.jsxs)("div",{className:"flex w-32 cursor-pointer flex-row items-center rounded-md border border-[#0095D9] p-2",children:[(0,j.jsx)(r.dtF,{className:"ml-2 h-4 w-4 text-[#0095D9]"}),(0,j.jsx)("span",{className:"pl-2 text-sm text-[#0095D9]",children:(0,j.jsx)("button",{onClick:()=>{A("/editprofile")},children:"Edit Profile"})})]}),(0,j.jsxs)("div",{onClick:()=>C(!0),className:"border-[2px] border-[#0095D9] ml-4 flex w-32 cursor-pointer flex-row items-center rounded-md p-2",children:[(0,j.jsx)(a.reo,{className:"ml-2 h-4 w-4 text-[#0095D9]"}),(0,j.jsx)("span",{className:"pl-2 text-sm text-[#0095D9]",children:"Show QR"})]}),(0,j.jsx)("div",{onClick:async()=>{var e;const l=window.location.href,t=(null===L||void 0===L?void 0:L.fullName)||(null===L||void 0===L||null===(e=L.personalDetails)||void 0===e?void 0:e.fullName)||"Doctor",s={title:"Dr. ".concat(t," - Avijo Expert"),text:"Check out Dr. ".concat(t,"'s profile on Avijo Expert"),url:l};try{navigator.share&&navigator.canShare&&navigator.canShare(s)?(await navigator.share(s),g.oR.success("Profile shared successfully!")):(await navigator.clipboard.writeText(l),g.oR.success("Profile link copied to clipboard!"))}catch(i){if("AbortError"!==i.name)try{await navigator.clipboard.writeText(l),g.oR.success("Profile link copied to clipboard!")}catch(o){g.oR.error("Failed to share profile"),console.error("Share error:",o)}}},className:"border-[2px] border-[#0095D9] ml-4 flex cursor-pointer flex-row items-center rounded-full p-2",children:(0,j.jsx)(a.reo,{className:"h-4 w-4 text-[#0095D9]"})})]})})]})]}),(0,j.jsx)(h.A,{isOpen:k,closeModal:()=>C(!1),title:"QR Code",width:"max-w-md",children:(0,j.jsxs)("div",{ref:P,className:"flex flex-col items-center justify-center py-6",children:[(0,j.jsx)(f.X,{id:"qr-gen",value:window.location.href,size:300,level:"H",includeMargin:!0}),(0,j.jsxs)("div",{className:"mt-6 flex flex-row gap-3",children:[(0,j.jsx)("button",{onClick:()=>{var e;const l=null===(e=P.current)||void 0===e?void 0:e.querySelector("canvas");if(!l)return void g.oR.error("QR code not ready yet. Please wait a moment.");const t=l.toDataURL("image/png").replace("image/png","image/octet-stream"),s=document.createElement("a");s.href=t,s.download="qr-code.png",document.body.appendChild(s),s.click(),document.body.removeChild(s),g.oR.success("QR code downloaded successfully!")},className:"rounded-md bg-[#0095D9] px-6 py-2 text-sm font-medium text-white hover:bg-[#007fbf] transition-colors",children:"Download QR"}),(0,j.jsx)("button",{onClick:()=>C(!1),className:"rounded-md border border-[#0095D9] px-6 py-2 text-sm font-medium text-[#0095D9] hover:bg-[#eef9ff] transition-colors",children:"Close"})]})]})}),(0,j.jsx)("div",{className:"flex w-full flex-row border-b-2 bg-white p-2 shadow-md",children:N.map((e,l)=>(0,j.jsx)("div",{onClick:()=>D(l),className:"".concat(y===l?"border-b-2 border-[#0095D9]":"border-0"," m-2 ml-6 cursor-pointer items-center"),children:(0,j.jsx)("span",{className:"".concat(y===l?"text-[#0095D9]":"text-[#313131]"," text-md text-center"),children:e})},l))}),(()=>{switch(y){case 0:return(0,j.jsx)(w,{doctor:L});case 1:return(0,j.jsx)(b,{doctorProfileId:S});default:return}})()]})}):(0,j.jsx)(o.A,{children:(0,j.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,j.jsx)("p",{className:"text-red-500",children:"Doctor profile not found"})})})}const w=e=>{var l,t,s,i,o,r,a,d,n,c;let{doctor:x}=e;return x?(0,j.jsxs)("div",{className:"my-8 w-full flex flex-col gap-4",children:[(0,j.jsxs)("div",{className:"rounded-lg bg-white p-3 pl-1 pr-3 pb-4 shadow-md",children:[(0,j.jsx)("h2",{className:"text-lg font-semibold text-gray-800 mb-2",children:"About"}),(0,j.jsx)("p",{className:"text-gray-600 text-sm leading-relaxed",children:x.about||"No information provided"})]}),(0,j.jsxs)("div",{className:"rounded-lg bg-white p-3 pl-1 pr-3 pb-4 shadow-md",children:[(0,j.jsx)("h1",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Specialization"}),(0,j.jsx)("p",{className:"text-gray-600 text-sm leading-relaxed",children:Array.isArray(x.specialization)?null===(l=x.systemOfMedicine)||void 0===l?void 0:l.systemOfMedicine.join(", "):(null===(t=x.systemOfMedicine)||void 0===t?void 0:t.systemOfMedicine)||"Not specified"})]}),(0,j.jsxs)("div",{className:"rounded-lg bg-white p-3 pl-1 pr-3 pb-4 shadow-md",children:[(0,j.jsx)("h1",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Experience"}),(0,j.jsx)("div",{className:"text-gray-600 text-sm leading-relaxed",children:((e,l,t)=>{const s=(null===(e=x.currentWorkDetails)||void 0===e?void 0:e.experience)||x.experience||x.yearsOfExperience||(null===(l=x.currentWorkDetails)||void 0===l?void 0:l.yearsOfExperience);let i="";if(s){i=!isNaN(s)&&!isNaN(parseFloat(s))?"".concat(s," ").concat(1===Number(s)?"year":"years"):s}if(null!==(t=x.currentWorkDetails)&&void 0!==t&&t.currentlyWorking){var o;const e="".concat(x.currentWorkDetails.workStatus||""," ").concat((null===(o=x.currentWorkDetails)||void 0===o?void 0:o.natureOfWork)||"").trim();return(0,j.jsxs)("p",{children:["Currently Working \u2013 ",e,i&&" - ".concat(i)]})}return i?(0,j.jsxs)("p",{className:"mb-2",children:[(0,j.jsx)("span",{className:"font-medium",children:"Years of Experience:"})," "," ",i]}):null})()})]}),(0,j.jsxs)("div",{className:"rounded-lg bg-white p-3 pl-1 pr-3 pb-4 shadow-md",children:[(0,j.jsx)("h1",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Education"}),(0,j.jsxs)("p",{className:"text-gray-600 text-sm leading-relaxed",children:["Degree - ",(null===(s=x.qualificationDetails)||void 0===s?void 0:s.degreeName)||"Not specified"," ",(0,j.jsx)("br",{}),"College - ",(null===(i=x.qualificationDetails)||void 0===i?void 0:i.college)||"Not specified"," ",(0,j.jsx)("br",{}),"University - ",(null===(o=x.qualificationDetails)||void 0===o?void 0:o.university)||"Not specified"," ",(0,j.jsx)("br",{}),"Passout - ",(null===(r=x.qualificationDetails)||void 0===r?void 0:r.passingMonth)||"Not specified",", ",(null===(a=x.qualificationDetails)||void 0===a?void 0:a.passingYear)||"Not specified"]})]}),(0,j.jsxs)("div",{className:"rounded-lg bg-white p-3 pl-1 pr-3 pb-4 shadow-md",children:[(0,j.jsx)("h1",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Clinic Details"}),(0,j.jsxs)("p",{className:"text-gray-600 text-sm leading-relaxed",children:[(null===(d=x.placeOfWork)||void 0===d?void 0:d.facilityName)||"Not specified",", ",(null===(n=x.placeOfWork)||void 0===n?void 0:n.district)||" ",", ",(null===(c=x.placeOfWork)||void 0===c?void 0:c.state)||" ",(0,j.jsx)("br",{})]})]})]}):(0,j.jsx)("div",{className:"p-5 text-gray-500",children:"Loading profile..."})},b=e=>{let{doctorProfileId:l}=e;const[s,o]=(0,i.useState)([]),[r,a]=(0,i.useState)(!0),[n,c]=(0,i.useState)(null),x=(0,i.useCallback)(async()=>{try{var e;if(a(!0),!l)throw new Error("Doctor Profile ID is required");const t=await fetch("".concat("","/user/getAllReview?doctorProfileId=").concat(l,"&t=").concat(Date.now()),{method:"GET",headers:{"Content-Type":"application/json","Cache-Control":"no-cache",Pragma:"no-cache"}});if(!t.ok)throw new Error("HTTP error! status: ".concat(t.status));const s=await t.json();console.log("API Response:",s),console.log("Reviews array:",s.reviews),console.log("Number of reviews:",(null===(e=s.reviews)||void 0===e?void 0:e.length)||0),o(s.reviews||[]),c(null)}catch(t){c(t.message),console.error("Error fetching reviews:",t)}finally{a(!1)}},[l]);(0,i.useEffect)(()=>{x()},[l,x]);return r?(0,j.jsx)("div",{className:"flex justify-center items-center py-8",children:(0,j.jsx)("div",{className:"text-lg text-[#8E8E8E]",children:"Loading reviews..."})}):n?(0,j.jsx)("div",{className:"flex justify-center items-center py-8",children:(0,j.jsxs)("div",{className:"text-lg text-red-500",children:["Error loading reviews: ",n,(0,j.jsx)("button",{onClick:x,className:"ml-4 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Retry"})]})}):0===s.length?(0,j.jsx)("div",{className:"flex justify-center items-center py-8",children:(0,j.jsx)("div",{className:"text-lg text-[#8E8E8E]",children:"No reviews available"})}):(0,j.jsx)(j.Fragment,{children:s.map(e=>{var l,s,i,o,r;return(0,j.jsxs)("div",{className:"mt-6 flex flex-col items-center border p-8 shadow-lg",children:[(0,j.jsxs)("div",{className:"flex w-[90%] flex-row items-start justify-between",children:[(0,j.jsxs)("div",{className:"flex flex-row items-center",children:[(0,j.jsx)("img",{src:(null===(l=e.userId)||void 0===l?void 0:l.userImage)||t(1749),className:"h-[120px] w-[120px] rounded-full object-cover",alt:"".concat((null===(s=e.userId)||void 0===s?void 0:s.fullName)||"User"," profile"),onError:e=>{e.target.src=t(1749)}}),(0,j.jsxs)("div",{className:"flex flex-col pl-4",children:[(0,j.jsx)("span",{className:"text-[30px] text-[#555555] text-[Gilroy-SemiBold]",children:(null===(i=e.userId)||void 0===i?void 0:i.fullName)||"Anonymous User"}),(0,j.jsxs)("div",{className:"mt-4 flex flex-row",children:[(0,j.jsx)("span",{className:"text-[18px] text-[#8E8E8E] text-[Gilroy-SemiBold]",children:"Visited For"}),(0,j.jsx)("span",{className:"ml-2 text-[18px] text-[Gilroy-SemiBold] text-black",children:(null===(o=e.doctorProfileId)||void 0===o?void 0:o.specialization)||"General Consultation"})]}),(0,j.jsxs)("div",{className:"flex flex-row items-center",children:[(0,j.jsx)(d.A,{count:5,value:e.rating,size:24,isHalf:!0,emptyIcon:(0,j.jsx)("i",{className:"far fa-star-o"}),halfIcon:(0,j.jsx)("i",{className:"fa fa-star-half-alt"}),fullIcon:(0,j.jsx)("i",{className:"fa fa-star"}),activeColor:"#ffd700",edit:!1}),(0,j.jsxs)("span",{className:"text-md ml-2 text-[#555555]",children:["(",e.rating,")"]})]})]})]}),(0,j.jsx)("span",{className:"text-md text-[#8E8E8E]",children:(r=e.createdAt,new Date(r).toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"}))})]}),(0,j.jsx)("span",{className:"text-md mt-4 w-[90%] text-[#8E8E8E]",children:e.comment}),((l,t,s,i,o,r)=>{const a=(null===(l=e.doctorProfileId)||void 0===l||null===(t=l.currentWorkDetails)||void 0===t?void 0:t.experience)||(null===(s=e.doctorProfileId)||void 0===s?void 0:s.experience)||(null===(i=e.doctorProfileId)||void 0===i?void 0:i.yearsOfExperience)||(null===(o=e.doctorProfileId)||void 0===o||null===(r=o.currentWorkDetails)||void 0===r?void 0:r.yearsOfExperience);if(!a)return null;const d=!isNaN(a)&&!isNaN(parseFloat(a))?"".concat(a," ").concat(1===Number(a)?"year":"years"):a;return(0,j.jsxs)("div",{className:"mt-2 w-[90%] text-sm text-[#8E8E8E]",children:["Doctor Experience: ",d]})})()]},e._id)})})}}}]);