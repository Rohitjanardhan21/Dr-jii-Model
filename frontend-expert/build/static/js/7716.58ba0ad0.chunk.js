"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[7716],{53663:()=>{},61094:(e,t,s)=>{s.d(t,{A:()=>p});var a=s(89379),r=s(9950),l=s(28429),i=s(42074),o=s(26910),d=s(54826),n=s(6604),c=s(35887),m=s(28504),u=s(44414);var x=s(9449);const p=()=>{const e=(0,l.Zp)(),[t,s]=(0,r.useState)(!1),[p,b]=(0,r.useState)(!1),[g,h]=(0,r.useState)(!1),[f,y]=(0,r.useState)(!1),[v,j]=(0,r.useState)(!1),[w,N]=(0,r.useState)(!1),[A,P]=(0,r.useState)(!1),[T,k]=(0,r.useState)(""),[O,S]=(0,r.useState)(null),[D,q]=(0,r.useState)(!1),[C,E]=(0,r.useState)(null),[I,L]=(0,r.useState)(null),[F,$]=(0,r.useState)(!1),{getDoctorData:V}=(0,m.S)(),{register:R,handleSubmit:U,setValue:z,formState:{errors:B}}=(0,x.mN)(),{Login:M}=(0,m.S)(),{register:Z,handleSubmit:_,formState:{errors:K},reset:H}=(0,x.mN)({defaultValues:{forgotEmail:""}});return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("section",{className:"flex items-center justify-center p-2 sm:p-4 bg-gray-100",children:(0,u.jsxs)("div",{className:"w-full max-w-4xl lg:max-w-5xl rounded-lg border mt-3 p-4 sm:p-6 md:p-10 lg:p-14 bg-white shadow-lg flex flex-col lg:flex-row",children:[(0,u.jsxs)("div",{className:"w-full lg:w-4/5 pr-0 lg:pr-6 mb-4 lg:mb-0 hidden md:block",children:[(0,u.jsx)("h4",{className:"text-base sm:text-lg md:text-xl font-semibold text-gray-600 mb-4",children:"Keep track of your patient's health with this powerful app that makes it easy to communicate with them."}),(0,u.jsxs)("ul",{className:"list-disc list-inside text-gray-700 space-y-2 text-sm sm:text-base",children:[(0,u.jsx)("li",{children:"Create a professional profile"}),(0,u.jsx)("li",{children:"Set available timings"}),(0,u.jsx)("li",{children:"Accept/Reject appointments"}),(0,u.jsx)("li",{children:"Real-time chat with patients"}),(0,u.jsx)("li",{children:"Read patient reviews"}),(0,u.jsx)("li",{children:"Check customer reviews"}),(0,u.jsx)("li",{children:"Easy login with OTP verification"}),(0,u.jsx)("li",{children:"Multi-Lingual support including RTL"})]})]}),(0,u.jsxs)("div",{className:"w-full lg:w-3/5 border-t lg:border-t-0 lg:border-l pt-4 lg:pt-0 lg:pl-6 shadow p-3 sm:p-4 md:p-6 rounded",children:[(0,u.jsxs)("form",{onSubmit:U(async t=>{h(!0);let s={};if(D&&C){try{const s=(0,a.A)({loginToken:C},F?{backupCode:t.code}:{token:t.totpToken}),r=await o.A.post("".concat("","/auth/login/totp"),s,{headers:{"Content-Type":"application/json"},withCredentials:!0});if(200===r.data.statusCode){const t=await V();t?(c.Ay.success("Login successful!"),t&&e("/dashboard")):c.Ay.error("Failed to fetch user data")}else c.Ay.error(r.data.message||"Invalid TOTP code")}catch($){var r,l,i;console.error("TOTP verification error:",$);const e=(null===(r=$.response)||void 0===r||null===(l=r.data)||void 0===l?void 0:l.message)||"Failed to verify TOTP";var d;if(429===(null===(i=$.response)||void 0===i?void 0:i.status))c.Ay.error("Too many failed attempts. Please try again after ".concat(new Date(null===(d=$.response.data.data)||void 0===d?void 0:d.lockedUntil).toLocaleTimeString()));else c.Ay.error(e)}finally{h(!1)}return}if(A&&t.emailOtp){const s={email:T,otp:t.emailOtp.toString().trim()};try{var n,u;const t=await o.A.post("".concat("","/doctor/verify-login-otp"),s,{withCredentials:!0,headers:{"Content-Type":"application/json",Accept:"application/json"}});if(null!==(n=t.data)&&void 0!==n&&n.success&&null!==(u=t.data)&&void 0!==u&&u.data){const s=t.data.data;null!==s&&void 0!==s&&s._id&&localStorage.setItem("userId",s._id);const{setDoctor:r}=m.S.getState();r((0,a.A)((0,a.A)({},s),{},{personalDetails:{fullName:s.fullName||"",emailId:s.emailId||"",mobileNumber:s.mobileNumber||""},addressPerKyc:{address:s.address||"",pincode:s.pincode||"",state:s.state||"",district:s.district||"",country:s.country||""}})),c.Ay.success("OTP verified successfully! Login successful."),e("/dashboard")}else{var x;c.Ay.error((null===(x=t.data)||void 0===x?void 0:x.message)||"OTP verification failed")}}catch($){var b,g;const e=(null===(b=$.response)||void 0===b||null===(g=b.data)||void 0===g?void 0:g.message)||$.message||"OTP verification failed";e.toLowerCase().includes("invalid")||e.toLowerCase().includes("expired")?c.Ay.error("Invalid or expired OTP. Please check and try again."):e.toLowerCase().includes("not found")?c.Ay.error("OTP not found. Please request a new OTP."):c.Ay.error(e)}finally{h(!1)}return}const f=t.email.trim();let y={};if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(f))y={email:f};else if(/^[0-9]{10}$/.test(f))y={mobileNumber:f};else{if(!/^[a-zA-Z0-9]+$/.test(f))return c.Ay.error("Please enter a valid email, mobile number, or Doctor ID."),void h(!1);y={doctorId:f}}s=p?(0,a.A)((0,a.A)({},y),{},{otp:t.otp}):(0,a.A)((0,a.A)({},y),{},{password:t.password});try{const t=await M(s,e);if(null!==t&&void 0!==t&&t.requiresTotp&&null!==t&&void 0!==t&&t.loginToken)return q(!0),E(t.loginToken),L(t.userId),void c.Ay.success("Password verified. Please enter your TOTP code.");null!==t&&void 0!==t&&t.emailVerificationRequired&&(P(!0),k(t.email),S(s),c.Ay.success("OTP sent to ".concat(t.email,". Please enter the OTP to continue.")))}catch($){var v,j,w,N,O,I;console.error("Login Failed:",$),"User not found"===(null===(v=$.response)||void 0===v||null===(j=v.data)||void 0===j?void 0:j.message)?(c.Ay.error("User not found. Please make an account."),e("/register")):"Invalid password"===(null===(w=$.response)||void 0===w||null===(N=w.data)||void 0===N?void 0:N.message)?c.Ay.error("Invalid password"):"Inavlid OTP"===(null===(O=$.response)||void 0===O||null===(I=O.data)||void 0===I?void 0:I.message)?c.Ay.error("Invalid OTP"):c.Ay.error("Login failed. Please check your credentials.")}finally{h(!1)}}),className:"space-y-4 sm:space-y-6",children:[D&&C?(0,u.jsx)("div",{className:"space-y-4",children:(0,u.jsxs)("div",{className:"rounded-lg bg-blue-50 border border-blue-200 p-4",children:[(0,u.jsx)("p",{className:"text-sm text-blue-800 mb-4",children:"Two-factor authentication is enabled. Please enter the 6-digit code from your authenticator app."}),(0,u.jsx)("div",{className:"mb-4",children:(0,u.jsx)("button",{type:"button",onClick:()=>{$(!F),z("totpToken",""),z("code","")},className:"text-sm text-[#0095D9] hover:underline",children:F?"Use authenticator app code":"Use backup code instead"})}),F?(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block font-medium text-gray-700 text-sm sm:text-base mb-1",children:"Enter backup code"}),(0,u.jsx)("input",(0,a.A)((0,a.A)({type:"text"},R("code",{required:"Backup code is required",pattern:{value:/^[0-9]{8}$/,message:"Backup code must be 8 digits"}})),{},{className:"w-full rounded-lg border p-2.5 sm:p-3 text-sm sm:text-base focus:border-[#0095D9] focus:ring-[#0095D9]",placeholder:"00000000",maxLength:8})),B.code&&(0,u.jsx)("p",{className:"text-xs sm:text-sm text-red-500 mt-1",children:B.code.message})]}):(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block font-medium text-gray-700 text-sm sm:text-base mb-1",children:"Enter 6-digit code"}),(0,u.jsx)("input",(0,a.A)((0,a.A)({type:"text"},R("totpToken",{required:"TOTP code is required",pattern:{value:/^[0-9]{6}$/,message:"TOTP code must be 6 digits"}})),{},{className:"w-full rounded-lg border p-2.5 sm:p-3 text-sm sm:text-base focus:border-[#0095D9] focus:ring-[#0095D9]",placeholder:"000000",maxLength:6})),B.totpToken&&(0,u.jsx)("p",{className:"text-xs sm:text-sm text-red-500 mt-1",children:B.totpToken.message})]}),(0,u.jsx)("button",{type:"submit",disabled:g,className:"w-full rounded-lg bg-[#0095D9] py-2.5 sm:py-3 font-semibold text-white hover:bg-[#007bbd] text-sm sm:text-base disabled:opacity-50 disabled:cursor-not-allowed",children:g?"Verifying...":"Verify & Login"})]})}):A?(0,u.jsxs)("div",{className:"space-y-4",children:[(0,u.jsx)("div",{className:"rounded-lg bg-blue-50 border border-blue-200 p-4",children:(0,u.jsxs)("p",{className:"text-sm text-blue-800 mb-2",children:["Email verification required. We've sent a 6-digit OTP to ",(0,u.jsx)("strong",{children:T})]})}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block font-medium text-gray-700 text-sm sm:text-base",children:"Enter Email Verification OTP"}),(0,u.jsx)("input",(0,a.A)((0,a.A)({type:"text"},R("emailOtp",{required:"OTP is required",pattern:{value:/^[0-9]{6}$/,message:"OTP must be 6 digits"}})),{},{className:"mt-1 w-full rounded-lg border p-2.5 sm:p-3 text-sm sm:text-base focus:border-[#0095D9] focus:ring-[#0095D9]",placeholder:"Enter 6-digit OTP",maxLength:6})),B.emailOtp&&(0,u.jsx)("p",{className:"text-xs sm:text-sm text-red-500 mt-1",children:B.emailOtp.message})]}),(0,u.jsx)("button",{type:"button",onClick:()=>{P(!1),k(""),S(null),z("emailOtp","")},className:"text-[#0095D9] hover:underline text-xs sm:text-sm font-medium",children:"Back to login"})]}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block font-medium text-gray-700 text-sm sm:text-base",children:"Mobile Number / HF ID / Email ID"}),(0,u.jsx)("input",(0,a.A)((0,a.A)({type:"text"},R("email",{required:"Email, mobile number, or Doctor ID is required"})),{},{className:"mt-1 w-full rounded-lg border p-2.5 sm:p-3 text-sm sm:text-base focus:border-[#0095D9] focus:ring-[#0095D9]",placeholder:"Enter email, mobile, or ID"})),B.email&&(0,u.jsx)("p",{className:"text-red-500 text-xs sm:text-sm mt-1",children:B.email.message})]}),p?(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block font-medium text-gray-700 text-sm sm:text-base",children:"Enter OTP"}),(0,u.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2 sm:space-x-2",children:[(0,u.jsx)("input",(0,a.A)((0,a.A)({type:"text"},R("otp",{required:"OTP is required"})),{},{className:"w-full rounded-lg border p-2.5 sm:p-3 text-sm sm:text-base focus:border-[#0095D9] focus:ring-[#0095D9]",placeholder:"Enter 6-digit OTP",maxLength:6})),f?(0,u.jsx)("button",{type:"button",className:"cursor-not-allowed rounded-lg bg-gray-300 px-4 py-2.5 sm:py-2 text-gray-700 text-sm sm:text-base whitespace-nowrap",disabled:!0,children:"OTP Sent"}):(0,u.jsx)("button",{type:"button",onClick:()=>(async e=>{let t={};if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e))t={email:e};else if(/^[0-9]{10}$/.test(e))t={mobileNumber:e};else{if(!/^[a-zA-Z0-9]+$/.test(e))return void c.Ay.error("Please enter a valid email, mobile number, or Doctor ID.");t={doctorId:e}}try{var s;const e=await o.A.post("".concat("","/doctor/send-otp"),t);var a,r;null!==(s=e.data)&&void 0!==s&&s.success?(c.Ay.success((null===(a=e.data)||void 0===a?void 0:a.message)||"OTP sent successfully!"),y(!0)):(c.Ay.error((null===(r=e.data)||void 0===r?void 0:r.message)||"Failed to send OTP. Please try again."),y(!1))}catch(i){var l;const e=i.response;console.error("OTP Sending Failed:",null!==e&&void 0!==e?e:i);const t=null===e||void 0===e?void 0:e.status,s=null===e||void 0===e||null===(l=e.data)||void 0===l?void 0:l.message;409===t?c.Ay.error(s||"OTP already requested. Please wait before requesting again."):c.Ay.error(s||"Failed to send OTP. Please try again."),y(!1)}})(document.querySelector('input[name="email"]').value),className:"rounded-lg bg-[#0095D9] px-4 py-2.5 sm:py-2 text-white hover:bg-[#007bbd] text-sm sm:text-base whitespace-nowrap",children:"Send OTP"})]}),B.otp&&(0,u.jsx)("p",{className:"text-xs sm:text-sm text-red-500 mt-1",children:B.otp.message})]}):(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{className:"block font-medium text-gray-700 text-sm sm:text-base",children:"Password"}),(0,u.jsxs)("div",{className:"relative",children:[(0,u.jsx)("input",(0,a.A)((0,a.A)({type:t?"text":"password"},R("password",{required:"Password is required"})),{},{className:"mt-1 w-full rounded-lg border p-2.5 sm:p-3 pr-10 text-sm sm:text-base focus:border-[#0095D9] focus:ring-[#0095D9]",placeholder:"Enter your password"})),(0,u.jsx)("button",{type:"button",onClick:()=>s(!t),className:"absolute inset-y-0 right-3 flex items-center text-gray-600",children:t?(0,u.jsx)(d.mx3,{className:"w-4 h-4 sm:w-5 sm:h-5"}):(0,u.jsx)(d.Ny1,{className:"w-4 h-4 sm:w-5 sm:h-5"})})]}),B.password&&(0,u.jsx)("p",{className:"text-xs sm:text-sm text-red-500 mt-1",children:B.password.message})]})]}),!D&&!A&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 text-xs sm:text-sm text-gray-400",children:[(0,u.jsxs)("label",{className:"flex items-center",children:[(0,u.jsx)("input",(0,a.A)((0,a.A)({type:"checkbox"},R("rememberMe")),{},{className:"mr-2"})),(0,u.jsx)("span",{children:"Remember me for 30 days"})]}),(0,u.jsx)("button",{type:"button",onClick:()=>j(!0),className:"text-[#0095D9] hover:underline whitespace-nowrap",children:"Forgot password?"})]}),(0,u.jsx)("div",{className:"text-left",children:(0,u.jsx)("button",{type:"button",onClick:()=>{b(!p),y(!1),z("otp","")},className:"text-[#0095D9] hover:underline text-xs sm:text-sm font-medium",children:p?"Login with Password":"Login with OTP"})})]}),(0,u.jsx)("button",{type:"submit",className:"w-full rounded-lg bg-[#0095D9] py-2.5 sm:py-3 font-semibold text-white hover:bg-[#007bbd] text-sm sm:text-base disabled:opacity-50 disabled:cursor-not-allowed",disabled:g,children:g?(0,u.jsx)("span",{className:"h-5 w-5 animate-spin rounded-full border-2 border-white border-t-transparent"}):A?"Verify & Login":D?"Verifying...":"Login"})]}),(0,u.jsxs)("div",{className:"mt-4 text-center text-xs sm:text-sm text-gray-500",children:["Don't have an account?"," ",(0,u.jsx)(i.N_,{to:"/signup",className:"text-[#0095D9] hover:underline",children:"Sign up"})]})]})]})}),v&&(0,u.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4",children:(0,u.jsxs)("div",{className:"relative w-full max-w-md rounded-lg bg-white p-4 sm:p-6",children:[(0,u.jsx)("button",{type:"button",onClick:()=>{j(!1),H()},className:"absolute right-4 top-4 text-gray-500 hover:text-gray-700",children:(0,u.jsx)(n.$8F,{size:24})}),(0,u.jsx)("h2",{className:"mb-2 text-xl sm:text-2xl font-semibold text-gray-800",children:"Find Your Account"}),(0,u.jsx)("p",{className:"mb-6 text-sm sm:text-base text-gray-600",children:"Please enter your email to reset your password."}),(0,u.jsx)(x.Op,{register:Z,handleSubmit:_,formState:{errors:K},children:(0,u.jsxs)("form",{onSubmit:_(async e=>{N(!0);try{(await o.A.post("".concat("","/doctor/forgetPassword"),{emailId:e.forgotEmail.trim()})).data.success&&(c.Ay.success("Password reset link has been sent to your email"),j(!1),H())}catch(a){var t,s;console.error("Password Reset Failed:",a),c.Ay.error((null===(t=a.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.message)||"Failed to send reset link. Please try again.")}finally{N(!1)}}),className:"space-y-6",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("input",(0,a.A)((0,a.A)({type:"email"},Z("forgotEmail",{required:"Email is required",pattern:{value:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"Please enter a valid email address"}})),{},{placeholder:"enter your email",className:"w-full rounded-lg border p-2.5 sm:p-3 text-sm sm:text-base focus:border-blue-500 focus:ring-2 focus:ring-blue-500 ".concat(K.forgotEmail?"border-red-500":"")})),K.forgotEmail&&(0,u.jsx)("p",{className:"mt-1 text-sm text-red-500",children:K.forgotEmail.message})]}),(0,u.jsx)("div",{className:"flex justify-end",children:(0,u.jsx)("button",{type:"submit",disabled:w,className:"rounded-lg bg-blue-500 px-4 sm:px-6 py-2 text-sm sm:text-base text-white ".concat(w?"cursor-not-allowed opacity-50":"hover:bg-blue-600"),children:w?"Submitting...":"Submit"})})]})})]})})]})}}}]);