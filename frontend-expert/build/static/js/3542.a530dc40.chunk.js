"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[3542],{83542:(e,t,a)=>{a.r(t),a.d(t,{default:()=>y});var s=a(89379),r=a(9950),l=a(17340),i=a(28429),n=a(28504),o=a(26910),c=a(35887);const d=function(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&e instanceof FormData?e:{personalDetails:{fullName:e.fullName||e.displayName||""},systemOfMedicine:{systemOfMedicine:e.specialization||e.systemOfMedicine||""},qualificationDetails:{degreeName:e.degree||e.education||e.degreeName||""},placeOfWork:{facilityName:e.clinicDetails||e.facilityName||""},about:e.about||"",currentWorkDetails:{workStatus:e.experience||e.workStatus||"",natureOfWork:e.natureOfWork||""},mobile:e.mobile||e.mobileNumber||""}};var u=a(85571),m=a(44414);function x(e){var t,a;let{doctor:l,emailVerificationRequired:d,setEmailVerificationRequired:u}=e;(0,i.Zp)();const{setDoctor:x}=(0,n.S)(),b=(null===l||void 0===l||null===(t=l.personalDetails)||void 0===t?void 0:t.emailId)||(null===l||void 0===l?void 0:l.emailId)||"example@gmail.com",h=(null===l||void 0===l?void 0:l.secondaryEmailId)||null,p=(null===l||void 0===l||null===(a=l.addressPerKyc)||void 0===a?void 0:a.country)||(null===l||void 0===l?void 0:l.country)||"Pakistan",g=(null===l||void 0===l?void 0:l.googleEmail)||b,f=(null===l||void 0===l?void 0:l.googleEmail)&&(null===l||void 0===l?void 0:l.googleEmail)!==b,[y,v]=(0,r.useState)(!1),[j,N]=(0,r.useState)(!1),[w,A]=(0,r.useState)(!1),[k,C]=(0,r.useState)(!1),[S,D]=(0,r.useState)(!1),[E,P]=(0,r.useState)(""),[I,F]=(0,r.useState)(""),[L,R]=(0,r.useState)(""),[z,q]=(0,r.useState)(""),[M,_]=(0,r.useState)(!1);(0,r.useEffect)(()=>{void 0!==(null===l||void 0===l?void 0:l.emailVerificationRequired)&&u(l.emailVerificationRequired)},[l,u]);return(0,m.jsxs)("div",{className:"max-w-3xl",children:[(0,m.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-6 border-b border-gray-200 pb-3",children:"Account Settings"}),(0,m.jsxs)("div",{className:"mb-8 pb-6 border-b border-gray-200",children:[(0,m.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),(0,m.jsxs)("div",{className:"flex items-center justify-between",children:[(0,m.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("span",{className:"text-gray-900",children:b}),(0,m.jsx)("span",{className:"ml-2 text-gray-600",children:"Primary Email"})]}),h&&(0,m.jsxs)("div",{children:[(0,m.jsx)("span",{className:"text-gray-900",children:h}),(0,m.jsx)("span",{className:"ml-2 text-gray-600",children:"Secondary Email"})]})]}),(0,m.jsx)("button",{onClick:()=>v(!0),className:"text-blue-600 hover:text-blue-800 underline text-sm",children:"Add Another Email Address"})]})]}),(0,m.jsxs)("div",{className:"mb-8 pb-6 border-b border-gray-200",children:[(0,m.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),(0,m.jsx)("button",{onClick:()=>N(!0),className:"text-blue-600 hover:text-blue-800 underline text-sm",children:"Change Password"})]}),(0,m.jsxs)("div",{className:"mb-8 pb-6 border-b border-gray-200",children:[(0,m.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Country of residence"}),(0,m.jsxs)("div",{className:"flex items-center justify-between",children:[(0,m.jsx)("span",{className:"text-gray-900",children:p}),(0,m.jsx)("button",{onClick:()=>A(!0),className:"text-gray-500 hover:text-gray-700 underline text-sm",children:"Learn more"})]})]}),(0,m.jsxs)("div",{className:"mb-8 pb-6 border-b border-gray-200",children:[(0,m.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Logout"}),(0,m.jsx)("button",{onClick:()=>D(!0),className:"text-blue-600 hover:text-blue-800 underline text-sm",disabled:M,children:"Log out of all other browsers"})]}),(0,m.jsxs)("div",{className:"mb-8 pb-6 border-b border-gray-200",children:[(0,m.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Login security"}),(0,m.jsxs)("div",{className:"flex items-center justify-between",children:[(0,m.jsx)("span",{className:"text-gray-900",children:"Require email verification"}),(0,m.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,m.jsx)("input",{type:"checkbox",checked:d,onChange:e=>(async e=>{u(e);try{const t=null===l||void 0===l?void 0:l._id;if(!t)return c.Ay.error("Doctor ID not found"),void u(!e);const a=await o.A.put("".concat("","/doctor/doctorProfile/update/").concat(t),{emailVerificationRequired:e},{withCredentials:!0});a.data.success||200===a.status?(c.Ay.success("Email verification setting updated"),a.data.data&&x(e=>(0,s.A)((0,s.A)({},e),a.data.data))):u(!e)}catch(r){var t,a;c.Ay.error((null===(t=r.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||"Failed to update email verification setting"),u(!e)}})(e.target.checked),className:"sr-only peer"}),(0,m.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})]}),(0,m.jsxs)("div",{className:"mb-8",children:[(0,m.jsxs)("div",{className:"flex items-center justify-between mb-6 pb-3 border-b border-gray-200",children:[(0,m.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:"Connected Accounts & Contacts"}),(0,m.jsx)("button",{className:"text-gray-500 hover:text-gray-700 underline text-sm",children:"Learn more"})]}),(0,m.jsx)("div",{className:"mb-6 pb-6 border-b border-gray-200",children:(0,m.jsxs)("div",{className:"flex items-center justify-between",children:[(0,m.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Facebook"}),(0,m.jsx)("button",{className:"text-blue-600 hover:text-blue-800 underline text-sm",children:"Connect Facebook Account"})]})}),(0,m.jsx)("div",{children:(0,m.jsxs)("div",{className:"flex items-center justify-between",children:[(0,m.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Google"}),f?(0,m.jsxs)("div",{className:"flex items-center gap-3",children:[(0,m.jsx)("span",{className:"text-gray-900",children:g}),(0,m.jsx)("button",{onClick:()=>C(!0),className:"text-red-600 hover:text-red-800 underline text-sm",children:"Disconnect"})]}):(0,m.jsx)("button",{className:"text-blue-600 hover:text-blue-800 underline text-sm",children:"Connect Google Account"})]})})]}),y&&(0,m.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:e=>{e.target===e.currentTarget&&(v(!1),P(""))},children:(0,m.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[(0,m.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Add Another Email Address"}),(0,m.jsxs)("div",{className:"mb-4",children:[(0,m.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),(0,m.jsx)("input",{type:"email",value:E,onChange:e=>P(e.target.value),placeholder:"Enter email address",className:"w-full border rounded px-3 py-2 text-sm"})]}),(0,m.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,m.jsx)("button",{onClick:()=>{v(!1),P("")},className:"px-4 py-2 border border-gray-300 rounded text-sm hover:bg-gray-50",disabled:M,children:"Cancel"}),(0,m.jsx)("button",{onClick:async()=>{if(!E.trim())return void c.Ay.error("Please enter an email address");if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(E.trim())){_(!0);try{const e=null===l||void 0===l?void 0:l._id;if(!e)return void c.Ay.error("Doctor ID not found");const t=await o.A.put("".concat("","/doctor/doctorProfile/update/").concat(e),{secondaryEmailId:E.trim()},{withCredentials:!0});(t.data.success||200===t.status)&&(c.Ay.success("Additional email address added successfully"),P(""),v(!1),t.data.data?x(e=>(0,s.A)((0,s.A)((0,s.A)({},e),t.data.data),{},{secondaryEmailId:t.data.data.secondaryEmailId||E.trim()})):x(e=>(0,s.A)((0,s.A)({},e),{},{secondaryEmailId:E.trim()})))}catch(a){var e,t;c.Ay.error((null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||"Failed to add email address")}finally{_(!1)}}else c.Ay.error("Please enter a valid email address")},disabled:M,className:"px-4 py-2 bg-blue-600 text-white rounded text-sm hover:bg-blue-700 disabled:opacity-50",children:M?"Adding...":"Add Email"})]})]})}),j&&(0,m.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:e=>{e.target===e.currentTarget&&(N(!1),F(""),R(""),q(""))},children:(0,m.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[(0,m.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Change Password"}),(0,m.jsxs)("div",{className:"space-y-4",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Old Password"}),(0,m.jsx)("input",{type:"password",value:I,onChange:e=>F(e.target.value),placeholder:"Enter old password",className:"w-full border rounded px-3 py-2 text-sm"})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New Password"}),(0,m.jsx)("input",{type:"password",value:L,onChange:e=>R(e.target.value),placeholder:"Enter new password",className:"w-full border rounded px-3 py-2 text-sm"})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm Password"}),(0,m.jsx)("input",{type:"password",value:z,onChange:e=>q(e.target.value),placeholder:"Confirm new password",className:"w-full border rounded px-3 py-2 text-sm"})]})]}),(0,m.jsxs)("div",{className:"flex gap-3 justify-end mt-6",children:[(0,m.jsx)("button",{onClick:()=>{N(!1),F(""),R(""),q("")},className:"px-4 py-2 border border-gray-300 rounded text-sm hover:bg-gray-50",disabled:M,children:"Cancel"}),(0,m.jsx)("button",{onClick:async()=>{if(I&&L&&z)if(L.length<6)c.Ay.error("New password must be at least 6 characters");else if(L===z){_(!0);try{const e=null===l||void 0===l?void 0:l._id;if(!e)return void c.Ay.error("Doctor ID not found");const t=await o.A.put("".concat("","/doctor/change-password/").concat(e),{oldPassword:I,newPassword:L},{withCredentials:!0});(t.data.success||200===t.status)&&(c.Ay.success("Password changed successfully"),F(""),R(""),q(""),N(!1))}catch(a){var e,t;c.Ay.error((null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||"Failed to change password")}finally{_(!1)}}else c.Ay.error("New password and confirm password do not match");else c.Ay.error("Please fill in all fields")},disabled:M,className:"px-4 py-2 bg-blue-600 text-white rounded text-sm hover:bg-blue-700 disabled:opacity-50",children:M?"Changing...":"Change Password"})]})]})}),w&&(0,m.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:e=>{e.target===e.currentTarget&&A(!1)},children:(0,m.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[(0,m.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Country of Residence"}),(0,m.jsx)("p",{className:"text-gray-600 text-sm mb-4",children:"Your country of residence is used to determine which services and features are available to you. This information helps us comply with local regulations and provide you with the most relevant experience."}),(0,m.jsxs)("p",{className:"text-gray-600 text-sm mb-4",children:["Your current country of residence is: ",(0,m.jsx)("strong",{children:p})]}),(0,m.jsx)("p",{className:"text-gray-600 text-sm mb-6",children:"If you need to change your country of residence, please contact support."}),(0,m.jsx)("div",{className:"flex justify-end",children:(0,m.jsx)("button",{onClick:()=>A(!1),className:"px-4 py-2 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:"Close"})})]})}),k&&(0,m.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:e=>{e.target===e.currentTarget&&C(!1)},children:(0,m.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[(0,m.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Disconnect Google Account"}),(0,m.jsxs)("p",{className:"text-gray-600 text-sm mb-4",children:["Are you sure you want to disconnect your Google account (",g,")? You will need to use your email and password to sign in."]}),(0,m.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,m.jsx)("button",{onClick:()=>C(!1),className:"px-4 py-2 border border-gray-300 rounded text-sm hover:bg-gray-50",disabled:M,children:"Cancel"}),(0,m.jsx)("button",{onClick:async()=>{_(!0);try{const e=null===l||void 0===l?void 0:l._id;if(!e)return void c.Ay.error("Doctor ID not found");const t=await o.A.put("".concat("","/doctor/doctorProfile/update/").concat(e),{disconnectGoogle:!0},{withCredentials:!0});(t.data.success||200===t.status)&&(c.Ay.success("Google account disconnected successfully"),C(!1),t.data.data&&x(e=>(0,s.A)((0,s.A)({},e),t.data.data)))}catch(a){var e,t;c.Ay.error((null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||"Failed to disconnect Google account")}finally{_(!1)}},disabled:M,className:"px-4 py-2 bg-red-600 text-white rounded text-sm hover:bg-red-700 disabled:opacity-50",children:M?"Disconnecting...":"Disconnect"})]})]})}),S&&(0,m.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:e=>{e.target===e.currentTarget&&D(!1)},children:(0,m.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[(0,m.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Log out of all other browsers"}),(0,m.jsx)("p",{className:"text-gray-600 text-sm mb-4",children:"This will log you out of all other browsers and devices where you're currently signed in. You will remain signed in on this browser."}),(0,m.jsx)("p",{className:"text-gray-600 text-sm mb-6",children:"Are you sure you want to continue?"}),(0,m.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,m.jsx)("button",{onClick:()=>D(!1),className:"px-4 py-2 border border-gray-300 rounded text-sm hover:bg-gray-50",disabled:M,children:"Cancel"}),(0,m.jsx)("button",{onClick:async()=>{_(!0);try{const e=await o.A.post("".concat("","/doctor/logout-all"),{},{withCredentials:!0});e.data.success||200===e.status?(c.Ay.success("Logged out of all other browsers successfully"),D(!1)):c.Ay.error(e.data.message||"Failed to logout from other browsers")}catch(a){var e,t;c.Ay.error((null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||"Failed to logout from other browsers")}finally{_(!1)}},disabled:M,className:"px-4 py-2 bg-blue-600 text-white rounded text-sm hover:bg-blue-700 disabled:opacity-50",children:M?"Logging out...":"Log out of all other browsers"})]})]})})]})}function b(e){let{privacySettings:t,setPrivacySettings:a}=e;const[l,d]=(0,r.useState)(!1),[u,x]=(0,r.useState)(!1),[b,h]=(0,r.useState)(!1),[p,g]=(0,r.useState)(""),[f,y]=(0,r.useState)(""),[v,j]=(0,r.useState)(!1),[N,w]=(0,r.useState)(!1),{doctor:A,doctorLogout:k}=(0,n.S)(),C=(0,i.Zp)(),S=async()=>{try{const e=await fetch("".concat("","/doctor/settings/privacy"),{method:"GET",credentials:"include"}),t=await e.json();t.success?a(t.data):c.Ay.error(t.message||"Failed to fetch privacy settings")}catch(e){c.Ay.error("Server error fetching privacy settings")}},D=async e=>{if(l)return;const t=null===A||void 0===A?void 0:A._id;if(t){d(!0);try{const r=await fetch("".concat("","/doctor/settings/privacy/update"),{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify((0,s.A)((0,s.A)({},e),{},{doctorId:t}))}),l=await r.json();l.success?(a(l.data),c.Ay.success("Privacy settings updated successfully")):(c.Ay.error(l.message||"Failed to update privacy settings"),await S())}catch(r){c.Ay.error("Server error updating privacy settings"),await S()}finally{d(!1)}}else c.Ay.error("Doctor ID not found. Please log in again.")};(0,r.useEffect)(()=>{S()},[]);const E=async e=>{const r=!t[e];a(t=>(0,s.A)((0,s.A)({},t),{},{[e]:r})),await D({[e]:r})},P=async e=>{a(t=>(0,s.A)((0,s.A)({},t),{},{whoCanSendMessage:e})),await D({whoCanSendMessage:e})},I=async()=>{if(p.trim()){j(!0);try{var e;const t=(null===A||void 0===A||null===(e=A.docRefId)||void 0===e?void 0:e._id)||(null===A||void 0===A?void 0:A._id);if(!t)return c.Ay.error("Doctor ID not found. Please log in again."),x(!1),void g("");const a=await o.A.post("".concat("","/doctor/schedule-account-deletion"),{password:p,doctorId:t},{withCredentials:!0});if(a.data.success||200===a.status){c.Ay.success("Account scheduled for deletion in 30 days"),x(!1),g("");await k()&&C("/")}else c.Ay.error(a.data.message||"Failed to delete account. Please check your password.")}catch(s){var t,a;c.Ay.error((null===(t=s.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||"Failed to delete account. Please check your password.")}finally{j(!1)}}else c.Ay.error("Please enter your password to confirm account deletion")},F=async()=>{if(f.trim()){w(!0);try{var e;const t=(null===A||void 0===A||null===(e=A.docRefId)||void 0===e?void 0:e._id)||(null===A||void 0===A?void 0:A._id);if(!t)return c.Ay.error("Doctor ID not found. Please log in again."),h(!1),void y("");const a=await o.A.post("".concat("","/doctor/deactivate-account"),{password:f,doctorId:t},{withCredentials:!0});if(a.data.success||200===a.status){c.Ay.success("Account deactivated successfully"),h(!1),y("");await k()&&C("/")}else c.Ay.error(a.data.message||"Failed to deactivate account. Please check your password.")}catch(s){var t,a;c.Ay.error((null===(t=s.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||"Failed to deactivate account. Please check your password.")}finally{w(!1)}}else c.Ay.error("Please enter your password to confirm account deactivation")};return(0,m.jsxs)("div",{className:"max-w-3xl",children:[(0,m.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-6 border-b border-gray-200 pb-3",children:"Privacy Settings"}),(0,m.jsx)("div",{className:"mb-8 pb-6 border-b border-gray-200",children:(0,m.jsxs)("div",{className:"space-y-6",children:[(0,m.jsxs)("div",{children:[(0,m.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,m.jsx)("span",{className:"text-gray-900",children:"Allow search engine to index your name"}),(0,m.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,m.jsx)("input",{type:"checkbox",checked:t.allowSearchEngineIndex,onChange:()=>E("allowSearchEngineIndex"),className:"sr-only peer"}),(0,m.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),(0,m.jsx)("button",{className:"text-gray-500 hover:text-gray-700 underline text-sm",children:"Learn more"})]}),(0,m.jsxs)("div",{children:[(0,m.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,m.jsx)("span",{className:"text-gray-900",children:"Allow adult content in recommendations"}),(0,m.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,m.jsx)("input",{type:"checkbox",checked:t.allowAdultContent,onChange:()=>E("allowAdultContent"),className:"sr-only peer"}),(0,m.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),(0,m.jsx)("button",{className:"text-gray-500 hover:text-gray-700 underline text-sm",children:"Learn more"})]}),(0,m.jsx)("div",{children:(0,m.jsxs)("div",{className:"flex items-center justify-between",children:[(0,m.jsx)("span",{className:"text-gray-900",children:"Allow your profile to be discovered by email"}),(0,m.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,m.jsx)("input",{type:"checkbox",checked:t.allowProfileDiscoveryByEmail,onChange:()=>E("allowProfileDiscoveryByEmail"),className:"sr-only peer"}),(0,m.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})}),(0,m.jsxs)("div",{children:[(0,m.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,m.jsx)("span",{className:"text-gray-900",children:"Allow large language models to be trained on your content"}),(0,m.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,m.jsx)("input",{type:"checkbox",checked:t.allowLLMTraining,onChange:()=>E("allowLLMTraining"),className:"sr-only peer"}),(0,m.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),(0,m.jsx)("button",{className:"text-gray-500 hover:text-gray-700 underline text-sm",children:"Learn more"})]})]})}),(0,m.jsxs)("div",{className:"mb-8 pb-6 border-b border-gray-200",children:[(0,m.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Inbox Preferences"}),(0,m.jsxs)("div",{className:"mb-4",children:[(0,m.jsx)("p",{className:"text-gray-900 mb-4",children:"Who can send you message?"}),(0,m.jsxs)("div",{className:"space-y-3",children:[(0,m.jsxs)("label",{className:"flex items-center cursor-pointer",children:[(0,m.jsx)("input",{type:"radio",name:"whoCanSendMessage",value:"anyone",checked:"anyone"===t.whoCanSendMessage,onChange:()=>P("anyone"),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),(0,m.jsx)("span",{className:"ml-3 text-gray-900",children:"Anyone on Docare"})]}),(0,m.jsxs)("label",{className:"flex items-center cursor-pointer",children:[(0,m.jsx)("input",{type:"radio",name:"whoCanSendMessage",value:"followed",checked:"followed"===t.whoCanSendMessage,onChange:()=>P("followed"),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),(0,m.jsx)("span",{className:"ml-3 text-gray-900",children:"People I Follow and admins and moderators of spaces I follow"})]}),(0,m.jsxs)("label",{className:"flex items-center cursor-pointer",children:[(0,m.jsx)("input",{type:"radio",name:"whoCanSendMessage",value:"noone",checked:"noone"===t.whoCanSendMessage,onChange:()=>P("noone"),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),(0,m.jsx)("span",{className:"ml-3 text-gray-900",children:"No one"})]})]})]})]}),(0,m.jsxs)("div",{className:"mb-8 pb-6 border-b border-gray-200",children:[(0,m.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Comment Preferences"}),(0,m.jsxs)("div",{className:"flex items-center justify-between",children:[(0,m.jsx)("span",{className:"text-gray-900",children:"Allow people to comment on your answers and posts"}),(0,m.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,m.jsx)("input",{type:"checkbox",checked:t.allowComments,onChange:()=>E("allowComments"),className:"sr-only peer"}),(0,m.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})]}),(0,m.jsxs)("div",{className:"mb-8 pb-6 border-b border-gray-200",children:[(0,m.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Content Preferences"}),(0,m.jsxs)("div",{className:"space-y-6",children:[(0,m.jsxs)("div",{className:"flex items-center justify-between",children:[(0,m.jsx)("span",{className:"text-gray-900",children:"Allow GIF's to play automatically"}),(0,m.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,m.jsx)("input",{type:"checkbox",checked:t.allowGifsAutoPlay,onChange:()=>E("allowGifsAutoPlay"),className:"sr-only peer"}),(0,m.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),(0,m.jsxs)("div",{children:[(0,m.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,m.jsx)("span",{className:"text-gray-900",children:"Allow advertisers on Docare to promote your answers"}),(0,m.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,m.jsx)("input",{type:"checkbox",checked:t.allowAdvertisersPromote,onChange:()=>E("allowAdvertisersPromote"),className:"sr-only peer"}),(0,m.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),(0,m.jsx)("button",{className:"text-gray-500 hover:text-gray-700 underline text-sm",children:"Learn more"})]}),(0,m.jsxs)("div",{className:"flex items-center justify-between",children:[(0,m.jsx)("span",{className:"text-gray-900",children:"Notify your subscribers of your new questions"}),(0,m.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,m.jsx)("input",{type:"checkbox",checked:t.notifySubscribers,onChange:()=>E("notifySubscribers"),className:"sr-only peer"}),(0,m.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})]})]}),(0,m.jsxs)("div",{className:"mb-8",children:[(0,m.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Delete or Deactivate your Account"}),(0,m.jsxs)("div",{className:"space-y-3",children:[(0,m.jsx)("button",{onClick:()=>{h(!0)},className:"text-red-600 hover:text-red-800 underline text-sm",children:"Deactivate Account"}),(0,m.jsx)("div",{children:(0,m.jsx)("button",{onClick:()=>{x(!0)},className:"text-red-600 hover:text-red-800 underline text-sm",children:"Delete Account"})})]})]}),u&&(0,m.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:e=>{e.target===e.currentTarget&&(x(!1),g(""))},children:(0,m.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[(0,m.jsx)("h3",{className:"text-lg font-semibold mb-4 text-red-600",children:"Delete Account"}),(0,m.jsx)("p",{className:"text-gray-600 text-sm mb-4",children:"This action cannot be undone. Your account will be scheduled for deletion in 30 days. After deletion, all your data will be permanently removed."}),(0,m.jsx)("p",{className:"text-gray-600 text-sm mb-4",children:"To confirm, please enter your password:"}),(0,m.jsxs)("div",{className:"mb-4",children:[(0,m.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),(0,m.jsx)("input",{type:"password",value:p,onChange:e=>g(e.target.value),placeholder:"Enter your password",className:"w-full border border-gray-300 rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500",onKeyPress:e=>{"Enter"===e.key&&p.trim()&&I()}})]}),(0,m.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,m.jsx)("button",{onClick:()=>{x(!1),g("")},className:"px-4 py-2 border border-gray-300 rounded text-sm hover:bg-gray-50",disabled:v,children:"Cancel"}),(0,m.jsx)("button",{onClick:I,disabled:v||!p.trim(),className:"px-4 py-2 bg-red-600 text-white rounded text-sm hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed",children:v?"Deleting...":"Delete Account"})]})]})}),b&&(0,m.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:e=>{e.target===e.currentTarget&&(h(!1),y(""))},children:(0,m.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[(0,m.jsx)("h3",{className:"text-lg font-semibold mb-4 text-red-600",children:" Deactivate Account"}),(0,m.jsx)("p",{className:"text-gray-600 text-sm mb-4",children:"Your account will be deactivated and to reactivate it, you will need to login again."}),(0,m.jsx)("p",{className:"text-gray-600 text-sm mb-4",children:"To confirm, please enter your password:"}),(0,m.jsxs)("div",{className:"mb-4",children:[(0,m.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),(0,m.jsx)("input",{type:"password",value:f,onChange:e=>y(e.target.value),placeholder:"Enter your password",className:"w-full border border-gray-300 rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500",onKeyPress:e=>{"Enter"===e.key&&f.trim()&&F()}})]}),(0,m.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,m.jsx)("button",{onClick:()=>{h(!1),y("")},className:"px-4 py-2 border border-gray-300 rounded text-sm hover:bg-gray-50",disabled:N,children:"Cancel"}),(0,m.jsx)("button",{onClick:F,disabled:N||!f.trim(),className:"px-4 py-2 bg-red-600 text-white rounded text-sm hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed",children:N?"Deactivating...":"Deactivate Account"})]})]})})]})}function h(e){let{displaySettings:t,setDisplaySettings:a}=e;const[l,i]=(0,r.useState)(!1),n=(0,r.useRef)(!0),d=o.A.create({baseURL:"",withCredentials:!0}),u=async()=>{try{var e;const c=await d.get("/doctor/settings/display");var t,s,r,l,i,n,o,u;if(null!==(e=c.data)&&void 0!==e&&e.success)a({theme:(null===(t=c.data)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.theme)||(null===(r=c.data)||void 0===r||null===(l=r.settings)||void 0===l?void 0:l.theme)||"light",fontSize:(null===(i=c.data)||void 0===i||null===(n=i.data)||void 0===n?void 0:n.fontSize)||(null===(o=c.data)||void 0===o||null===(u=o.settings)||void 0===u?void 0:u.fontSize)||"medium"});else a({theme:"light",fontSize:"medium"})}catch(b){var m,x;c.Ay.error((null===(m=b.response)||void 0===m||null===(x=m.data)||void 0===x?void 0:x.message)||"Failed to fetch display settings"),a({theme:"light",fontSize:"medium"})}};(0,r.useEffect)(()=>{u().then(()=>{n.current=!1})},[]),(0,r.useEffect)(()=>{n.current||t.theme&&t.fontSize&&(async e=>{if(!l){i(!0);try{var t;const l=await d.put("/doctor/settings/display/update",e);var s,r;null!==(t=l.data)&&void 0!==t&&t.success?(null!==(s=l.data)&&void 0!==s&&s.data&&a(l.data.data),c.Ay.success("Display settings updated successfully")):(c.Ay.error((null===(r=l.data)||void 0===r?void 0:r.message)||"Failed to update display settings"),await u())}catch(m){var n,o;c.Ay.error((null===(n=m.response)||void 0===n||null===(o=n.data)||void 0===o?void 0:o.message)||"Server error updating display settings"),await u()}finally{i(!1)}}})(t)},[t.theme,t.fontSize]);const x=e=>{a(t=>(0,s.A)((0,s.A)({},t),{},{theme:e}))};return(0,m.jsxs)("div",{className:"max-w-3xl",children:[(0,m.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-6 border-b border-gray-200 pb-3",children:"Display Settings"}),(0,m.jsxs)("div",{className:"mb-8 pb-6 border-b border-gray-200",children:[(0,m.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Theme"}),(0,m.jsx)("p",{className:"text-gray-600 mb-4 text-sm",children:"Adjust how would you like Docare to appear on this browser."}),(0,m.jsxs)("div",{className:"flex gap-6",children:[(0,m.jsxs)("label",{className:"flex items-center cursor-pointer",children:[(0,m.jsx)("input",{type:"radio",name:"theme",value:"light",checked:"light"===t.theme,onChange:()=>x("light"),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),(0,m.jsx)("span",{className:"ml-2 text-gray-900",children:"Light"})]}),(0,m.jsxs)("label",{className:"flex items-center cursor-pointer",children:[(0,m.jsx)("input",{type:"radio",name:"theme",value:"dark",checked:"dark"===t.theme,onChange:()=>x("dark"),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),(0,m.jsx)("span",{className:"ml-2 text-gray-900",children:"Dark"})]}),(0,m.jsxs)("label",{className:"flex items-center cursor-pointer",children:[(0,m.jsx)("input",{type:"radio",name:"theme",value:"auto",checked:"auto"===t.theme,onChange:()=>x("auto"),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),(0,m.jsx)("span",{className:"ml-2 text-gray-900",children:"Auto"})]})]})]}),(0,m.jsxs)("div",{className:"mb-8",children:[(0,m.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Font size"}),(0,m.jsx)("p",{className:"text-gray-600 mb-4 text-sm",children:"Adjust how would you like Text size to appear on this browser."}),(0,m.jsxs)("div",{className:"relative",children:[(0,m.jsxs)("select",{value:t.fontSize,onChange:e=>{a(t=>(0,s.A)((0,s.A)({},t),{},{fontSize:e.target.value}))},className:"w-full max-w-xs border border-gray-300 rounded-md px-3 py-2 text-gray-900 bg-white appearance-none focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,m.jsx)("option",{value:"",children:"Select"}),(0,m.jsx)("option",{value:"small",children:"Small"}),(0,m.jsx)("option",{value:"medium",children:"Medium"}),(0,m.jsx)("option",{value:"large",children:"Large"}),(0,m.jsx)("option",{value:"xlarge",children:"Extra Large"})]}),(0,m.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:(0,m.jsx)("svg",{className:"w-5 h-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:(0,m.jsx)("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})]})]})}function p(e){let{emailNotifications:t,setEmailNotifications:a}=e;const[l,i]=(0,r.useState)(!1),n=(0,r.useRef)(!0),d=o.A.create({baseURL:"",withCredentials:!0}),u=async()=>{try{var e,t;const c=await d.get("/doctor/settings/email-notifications");var s,r,l,i,n,o,u,m,x,b,h,p,g,f,y,v;if(null!==(e=c.data)&&void 0!==e&&e.success&&null!==(t=c.data)&&void 0!==t&&t.data)a({newAnswers:null===(s=c.data.data.newAnswers)||void 0===s||s,requests:null===(r=c.data.data.requests)||void 0===r||r,messages:null===(l=c.data.data.messages)||void 0===l||l,commentsAndReplies:null===(i=c.data.data.commentsAndReplies)||void 0===i||i,mentions:null===(n=c.data.data.mentions)||void 0===n||n,spaceInvites:null===(o=c.data.data.spaceInvites)||void 0===o||o,spaceUpdates:null===(u=c.data.data.spaceUpdates)||void 0===u||u,spacesForYou:null===(m=c.data.data.spacesForYou)||void 0===m||m,newFollowers:null===(x=c.data.data.newFollowers)||void 0===x||x,upvotes:null===(b=c.data.data.upvotes)||void 0===b||b,shares:null===(h=c.data.data.shares)||void 0===h||h,moderation:null===(p=c.data.data.moderation)||void 0===p||p,docareDigest:null===(g=c.data.data.docareDigest)||void 0===g||g,digestFrequency:c.data.data.digestFrequency||"asAvailable",popularAnswers:null===(f=c.data.data.popularAnswers)||void 0===f||f,storiesBasedOnActivity:null===(y=c.data.data.storiesBasedOnActivity)||void 0===y||y,recommendedQuestions:null===(v=c.data.data.recommendedQuestions)||void 0===v||v})}catch(w){var j,N;console.error("Error fetching email notification settings:",w),c.Ay.error((null===(j=w.response)||void 0===j||null===(N=j.data)||void 0===N?void 0:N.message)||"Failed to fetch email notification settings")}},x=async e=>{if(!l){i(!0);try{var t;const l=await d.put("/doctor/settings/email-notifications/update",e);var r,n;if(null!==(t=l.data)&&void 0!==t&&t.success)null!==(r=l.data)&&void 0!==r&&r.data&&a(e=>(0,s.A)((0,s.A)({},e),l.data.data));else c.Ay.error((null===(n=l.data)||void 0===n?void 0:n.message)||"Failed to update email notification settings"),await u()}catch(x){var o,m;console.error("Error updating email notification settings:",x),c.Ay.error((null===(o=x.response)||void 0===o||null===(m=o.data)||void 0===m?void 0:m.message)||"Server error updating email notification settings"),await u()}finally{i(!1)}}};(0,r.useEffect)(()=>{u().then(()=>{n.current=!1})},[]);const b=async e=>{const r=!t[e];a(t=>(0,s.A)((0,s.A)({},t),{},{[e]:r})),await x((0,s.A)((0,s.A)({},t),{},{[e]:r}))},h=async e=>{a(t=>(0,s.A)((0,s.A)({},t),{},{digestFrequency:e})),await x((0,s.A)((0,s.A)({},t),{},{digestFrequency:e}))},p=e=>{let{checked:t,onChange:a,label:s,description:r}=e;return(0,m.jsxs)("div",{className:"mb-6",children:[(0,m.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,m.jsx)("span",{className:"text-gray-900 font-medium",children:s}),(0,m.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,m.jsx)("input",{type:"checkbox",checked:t,onChange:a,className:"sr-only peer"}),(0,m.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),r&&(0,m.jsx)("p",{className:"text-gray-600 text-sm",children:r})]})};return(0,m.jsxs)("div",{className:"max-w-3xl",children:[(0,m.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-6 border-b border-gray-200 pb-3",children:"Email & Notifications"}),(0,m.jsxs)("div",{className:"mb-8 pb-6 border-b border-gray-200",children:[(0,m.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Content Channels"}),(0,m.jsxs)("div",{className:"mb-6",children:[(0,m.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"General questions and answers"}),(0,m.jsx)(p,{checked:t.newAnswers,onChange:()=>b("newAnswers"),label:"New answers",description:"Email me when there are new answers to questions I asked or follow."}),(0,m.jsx)(p,{checked:t.requests,onChange:()=>b("requests"),label:"Requests",description:"Email me when when someone requests me to answer a question."})]}),(0,m.jsxs)("div",{className:"mb-6 pt-6 border-t border-gray-200",children:[(0,m.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Messages, comments and mentions"}),(0,m.jsx)(p,{checked:t.messages,onChange:()=>b("messages"),label:"Messages",description:"Email me when someone sends me a direct message."}),(0,m.jsx)(p,{checked:t.commentsAndReplies,onChange:()=>b("commentsAndReplies"),label:"Comments and replies",description:"Email me of comments on my content and replies to my comments."}),(0,m.jsx)(p,{checked:t.mentions,onChange:()=>b("mentions"),label:"Mentions",description:"Email me when someone mentions me."})]}),(0,m.jsxs)("div",{className:"pt-6 border-t border-gray-200",children:[(0,m.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Spaces"}),(0,m.jsx)(p,{checked:t.spaceInvites,onChange:()=>b("spaceInvites"),label:"Space invites",description:"Email me when someone invites me or accept my invitation to a space."}),(0,m.jsx)(p,{checked:t.spaceUpdates,onChange:()=>b("spaceUpdates"),label:"Space updates",description:"Email me when there are feature updates to my space."}),(0,m.jsx)(p,{checked:t.spacesForYou,onChange:()=>b("spacesForYou"),label:"Spaces for you",description:"Email me about Spaces I might like."}),(0,m.jsx)("div",{className:"mb-6",children:(0,m.jsxs)("div",{className:"flex items-center justify-between",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("span",{className:"text-gray-900 font-medium block mb-1",children:"Spaces you follow"}),(0,m.jsx)("p",{className:"text-gray-600 text-sm",children:"Email me with updates from spaces I follow at my preferred frequency."})]}),(0,m.jsx)("button",{className:"px-4 py-2 border border-blue-600 text-blue-600 rounded hover:bg-blue-50 transition",children:"Manage"})]})})]}),(0,m.jsxs)("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[(0,m.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Your network"}),(0,m.jsx)(p,{checked:t.newFollowers,onChange:()=>b("newFollowers"),label:"New followers",description:"Email me of new followers."}),(0,m.jsx)("div",{className:"mb-6",children:(0,m.jsxs)("div",{className:"flex items-center justify-between",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("span",{className:"text-gray-900 font-medium block mb-1",children:"People you follow"}),(0,m.jsx)("p",{className:"text-gray-600 text-sm",children:"Manage notifications from people that I follow"})]}),(0,m.jsx)("button",{className:"px-4 py-2 border border-blue-600 text-blue-600 rounded hover:bg-blue-50 transition",children:"Manage"})]})})]})]}),(0,m.jsxs)("div",{className:"mb-8 pb-6 border-b border-gray-200",children:[(0,m.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Activity on your content"}),(0,m.jsxs)("div",{className:"mb-6",children:[(0,m.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,m.jsx)("span",{className:"text-gray-900 font-medium",children:"Upvotes"}),(0,m.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,m.jsx)("input",{type:"checkbox",checked:t.upvotes,onChange:()=>b("upvotes"),className:"sr-only peer"}),(0,m.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),(0,m.jsx)("p",{className:"text-gray-600 text-sm",children:"Email me when someone upvotes my content."})]}),(0,m.jsxs)("div",{className:"mb-6",children:[(0,m.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,m.jsx)("span",{className:"text-gray-900 font-medium",children:"Shares"}),(0,m.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,m.jsx)("input",{type:"checkbox",checked:t.shares,onChange:()=>b("shares"),className:"sr-only peer"}),(0,m.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),(0,m.jsx)("p",{className:"text-gray-600 text-sm",children:"Email me when someone shares any of my content."})]}),(0,m.jsxs)("div",{children:[(0,m.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,m.jsx)("span",{className:"text-gray-900 font-medium",children:"Moderation"}),(0,m.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,m.jsx)("input",{type:"checkbox",checked:t.moderation,onChange:()=>b("moderation"),className:"sr-only peer"}),(0,m.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),(0,m.jsx)("p",{className:"text-gray-600 text-sm",children:"Email me when moderation actions are taken on my answers."})]})]}),(0,m.jsxs)("div",{className:"mb-8",children:[(0,m.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-6",children:"From Docare"}),(0,m.jsxs)("div",{className:"mb-6 pb-6 border-b border-gray-200",children:[(0,m.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,m.jsx)("span",{className:"text-gray-900 font-medium",children:"Docare Digest"}),(0,m.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,m.jsx)("input",{type:"checkbox",checked:t.docareDigest,onChange:()=>b("docareDigest"),className:"sr-only peer"}),(0,m.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),(0,m.jsx)("p",{className:"text-gray-600 text-sm",children:"Email me with the top stories on Docare"})]}),(0,m.jsxs)("div",{className:"mb-6 pb-6 border-b border-gray-200",children:[(0,m.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Digest Frequency:"}),(0,m.jsxs)("div",{className:"space-y-3",children:[(0,m.jsxs)("label",{className:"flex items-start cursor-pointer",children:[(0,m.jsx)("input",{type:"radio",name:"digestFrequency",value:"asAvailable",checked:"asAvailable"===t.digestFrequency,onChange:()=>h("asAvailable"),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500 mt-1"}),(0,m.jsxs)("div",{className:"ml-3",children:[(0,m.jsx)("span",{className:"text-gray-900 block",children:"As available"}),(0,m.jsx)("p",{className:"text-gray-600 text-sm",children:"Top stories as they become available."})]})]}),(0,m.jsxs)("label",{className:"flex items-start cursor-pointer",children:[(0,m.jsx)("input",{type:"radio",name:"digestFrequency",value:"daily",checked:"daily"===t.digestFrequency,onChange:()=>h("daily"),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500 mt-1"}),(0,m.jsxs)("div",{className:"ml-3",children:[(0,m.jsx)("span",{className:"text-gray-900 block",children:"Daily"}),(0,m.jsx)("p",{className:"text-gray-600 text-sm",children:"Up to digest every day, based on UTC."})]})]}),(0,m.jsxs)("label",{className:"flex items-start cursor-pointer",children:[(0,m.jsx)("input",{type:"radio",name:"digestFrequency",value:"weekly",checked:"weekly"===t.digestFrequency,onChange:()=>h("weekly"),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500 mt-1"}),(0,m.jsxs)("div",{className:"ml-3",children:[(0,m.jsx)("span",{className:"text-gray-900 block",children:"Weekly"}),(0,m.jsx)("p",{className:"text-gray-600 text-sm",children:"Exactly 1 digest per week."})]})]})]})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Things you might like"}),(0,m.jsx)(p,{checked:t.popularAnswers,onChange:()=>b("popularAnswers"),label:"Popular answers",description:"Email me with answers and shares upvoted by people I follow."}),(0,m.jsx)(p,{checked:t.storiesBasedOnActivity,onChange:()=>b("storiesBasedOnActivity"),label:"Stories based on my activity",description:"Email me with more stories related to things I read."}),(0,m.jsx)(p,{checked:t.recommendedQuestions,onChange:()=>b("recommendedQuestions"),label:"Recommended questions",description:"Email me with questions for me answer."})]})]})]})}function g(e){let{selectedLanguage:t,setSelectedLanguage:a}=e;const[s,l]=(0,r.useState)([]),[i,n]=(0,r.useState)(!0),[d,u]=(0,r.useState)(!1),x=(0,r.useRef)(!0),b=o.A.create({baseURL:"",withCredentials:!0}),h=async()=>{try{var e;n(!0);const t=await b.get("/doctor/settings/language");null!==(e=t.data)&&void 0!==e&&e.success&&(t.data.availableLanguages&&t.data.availableLanguages.length>0?l(t.data.availableLanguages):l([{code:"EN",name:"English",color:"bg-blue-500",isPrimary:!0},{code:"ES",name:"Espanol",color:"bg-orange-500",isPrimary:!1},{code:"FR",name:"Francis",color:"bg-green-500",isPrimary:!1},{code:"DE",name:"Deutch",color:"bg-purple-500",isPrimary:!1},{code:"IT",name:"Italiano",color:"bg-pink-500",isPrimary:!1},{code:"JA",name:"Javap",color:"bg-red-500",isPrimary:!1}]),t.data.selectedLanguage&&a(t.data.selectedLanguage))}catch(r){var t,s;console.error("Error fetching language settings:",r),c.Ay.error((null===(t=r.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.message)||"Failed to fetch language settings"),l([{code:"EN",name:"English",color:"bg-blue-500",isPrimary:!0},{code:"ES",name:"Espanol",color:"bg-orange-500",isPrimary:!1},{code:"FR",name:"Francis",color:"bg-green-500",isPrimary:!1},{code:"DE",name:"Deutch",color:"bg-purple-500",isPrimary:!1},{code:"IT",name:"Italiano",color:"bg-pink-500",isPrimary:!1},{code:"JA",name:"Javap",color:"bg-red-500",isPrimary:!1}])}finally{n(!1)}};(0,r.useEffect)(()=>{h().then(()=>{x.current=!1})},[]);const p=async e=>{a(e),await(async e=>{if(!d){u(!0);try{var t;const l=await b.put("/doctor/settings/language/update",{language:e});var s,r;null!==(t=l.data)&&void 0!==t&&t.success?(a(e),c.Ay.success((null===(s=l.data)||void 0===s?void 0:s.message)||"Language settings updated successfully")):(c.Ay.error((null===(r=l.data)||void 0===r?void 0:r.message)||"Failed to update language settings"),await h())}catch(n){var l,i;console.error("Error updating language settings:",n),c.Ay.error((null===(l=n.response)||void 0===l||null===(i=l.data)||void 0===i?void 0:i.message)||"Server error updating language settings"),await h()}finally{u(!1)}}})(e)};return i?(0,m.jsxs)("div",{className:"max-w-3xl",children:[(0,m.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-6 border-b border-gray-200 pb-3",children:"Language Settings"}),(0,m.jsx)("div",{className:"text-center py-12 text-gray-500",children:"Loading language settings..."})]}):(0,m.jsxs)("div",{className:"max-w-3xl",children:[(0,m.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-6 border-b border-gray-200 pb-3",children:"Language Settings"}),(0,m.jsx)("div",{className:"space-y-0",children:s.map((e,a)=>(0,m.jsx)("div",{children:(0,m.jsxs)("div",{className:"flex items-center justify-between py-4 cursor-pointer hover:bg-gray-50 transition ".concat(a<s.length-1?"border-b border-gray-200":""," ").concat(t===e.name?"bg-blue-50":""," ").concat(d?"opacity-50 cursor-not-allowed":""),onClick:()=>!d&&p(e.name),children:[(0,m.jsxs)("div",{className:"flex items-center gap-4",children:[(0,m.jsx)("div",{className:"".concat(e.color," w-10 h-10 rounded-full flex items-center justify-center text-white font-semibold text-sm"),children:e.code}),(0,m.jsx)("span",{className:"text-gray-900 font-medium",children:e.name})]}),(0,m.jsxs)("div",{className:"flex items-center gap-3",children:[t===e.name&&(0,m.jsx)("span",{className:"text-blue-600 text-sm font-medium",children:"Selected"}),e.isPrimary&&(0,m.jsx)("span",{className:"text-gray-500 text-sm",children:"Primary"})]})]})},e.code))})]})}function f(){const{doctor:e}=(0,n.S)(),[t,a]=(0,r.useState)(!1),[s,l]=(0,r.useState)("subscriptions"),[i,d]=(0,r.useState)([]),[u,x]=(0,r.useState)([]),[b,h]=(0,r.useState)(!1),[p,g]=(0,r.useState)(!1),[f,y]=(0,r.useState)([]),[v,j]=(0,r.useState)(!1),[N,w]=(0,r.useState)(!1),[A,k]=(0,r.useState)([]),[C,S]=(0,r.useState)(!1),[D,E]=(0,r.useState)(null);(0,r.useEffect)(()=>{const e=document.createElement("script");return e.src="https://checkout.razorpay.com/v1/checkout.js",e.async=!0,document.body.appendChild(e),()=>{document.body.removeChild(e)}},[]);const P=async()=>{try{g(!0);const e=await o.A.get("".concat("","/api/subscriptions"),{withCredentials:!0});e.data.success&&x(e.data.data)}catch(e){console.error("Error fetching subscriptions:",e),c.Ay.error("Failed to load subscriptions")}finally{g(!1)}},I=async()=>{try{j(!0);const e=await o.A.get("".concat("","/api/subscriptions/payment-methods"),{withCredentials:!0});e.data.success&&y(e.data.data)}catch(e){console.error("Error fetching payment methods:",e),c.Ay.error("Failed to load payment methods")}finally{j(!1)}},F=async()=>{try{S(!0);const e=await o.A.get("".concat("","/api/subscriptions/billing/history"),{withCredentials:!0,params:{limit:50}});e.data.success&&k(e.data.data)}catch(e){console.error("Error fetching billing history:",e),c.Ay.error("Failed to load billing history")}finally{S(!1)}},L=async()=>{try{const e=await o.A.get("".concat("","/api/subscriptions/billing/summary"),{withCredentials:!0});e.data.success&&E(e.data.data)}catch(e){console.error("Error fetching billing summary:",e)}};(0,r.useEffect)(()=>{"subscriptions"===s?((async()=>{try{h(!0);const e=await o.A.get("".concat("","/api/subscriptions/plans"),{withCredentials:!0});e.data.success&&d(e.data.data)}catch(e){console.error("Error fetching plans:",e),c.Ay.error("Failed to load subscription plans")}finally{h(!1)}})(),P()):"payment-methods"===s?I():"billing"===s&&(F(),L())},[s]);const R=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A",z=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"INR";return new Intl.NumberFormat("en-IN",{style:"currency",currency:t}).format(e)},q=u.filter(e=>"active"===e.status);return(0,m.jsxs)("div",{className:"max-w-4xl",children:[(0,m.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-6 border-b border-gray-200 pb-3",children:"Subscriptions & Billing"}),(0,m.jsxs)("div",{className:"flex space-x-4 mb-6 border-b border-gray-200",children:[(0,m.jsx)("button",{onClick:()=>l("subscriptions"),className:"px-4 py-2 font-medium ".concat("subscriptions"===s?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"),children:"Space Subscriptions"}),(0,m.jsx)("button",{onClick:()=>l("payment-methods"),className:"px-4 py-2 font-medium ".concat("payment-methods"===s?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"),children:"Payment Methods"}),(0,m.jsx)("button",{onClick:()=>l("billing"),className:"px-4 py-2 font-medium ".concat("billing"===s?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"),children:"Billing History"})]}),"subscriptions"===s&&(0,m.jsxs)("div",{className:"space-y-6",children:[(0,m.jsxs)("div",{className:"border border-gray-200 rounded-lg p-6",children:[(0,m.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Active Subscriptions"}),p?(0,m.jsx)("div",{className:"text-center py-4",children:"Loading..."}):q.length>0?(0,m.jsx)("div",{className:"space-y-4",children:q.map(e=>{var s,r;return(0,m.jsx)("div",{className:"border border-gray-200 rounded-lg p-4",children:(0,m.jsxs)("div",{className:"flex justify-between items-start",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("h4",{className:"font-semibold text-gray-900",children:(null===(s=e.planId)||void 0===s?void 0:s.name)||"Unknown Plan"}),(0,m.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:(null===(r=e.planId)||void 0===r?void 0:r.description)||""}),(0,m.jsxs)("p",{className:"text-sm text-gray-500 mt-2",children:["Valid until: ",R(e.endDate)]}),(0,m.jsx)("span",{className:"inline-block mt-2 px-2 py-1 text-xs font-semibold rounded bg-green-100 text-green-800",children:e.status.toUpperCase()})]}),(0,m.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to cancel this subscription?"))try{a(!0),(await o.A.post("".concat("","/api/subscriptions/cancel"),{subscriptionId:e},{withCredentials:!0})).data.success&&(c.Ay.success("Subscription cancelled successfully"),P())}catch(r){var t,s;console.error("Error cancelling subscription:",r),c.Ay.error((null===(t=r.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.message)||"Failed to cancel subscription")}finally{a(!1)}})(e._id),className:"px-4 py-2 text-sm text-red-600 border border-red-600 rounded hover:bg-red-50",disabled:t,children:"Cancel"})]})},e._id)})}):(0,m.jsx)("p",{className:"text-gray-600 text-sm",children:"You are not currently a member of any space."})]}),(0,m.jsxs)("div",{className:"border border-gray-200 rounded-lg p-6",children:[(0,m.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Available Plans"}),b?(0,m.jsx)("div",{className:"text-center py-4",children:"Loading..."}):i.length>0?(0,m.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:i.map(s=>{var r;return(0,m.jsxs)("div",{className:"border rounded-lg p-4 ".concat(s.isPopular?"border-blue-500 bg-blue-50":"border-gray-200"),children:[s.isPopular&&(0,m.jsx)("span",{className:"inline-block mb-2 px-2 py-1 text-xs font-semibold rounded bg-blue-600 text-white",children:"POPULAR"}),(0,m.jsx)("h4",{className:"font-semibold text-gray-900 text-lg",children:s.name}),(0,m.jsx)("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:z(s.price,s.currency)}),(0,m.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["/ ",s.billingCycle]}),(0,m.jsx)("p",{className:"text-sm text-gray-600 mt-3",children:s.description}),(0,m.jsx)("ul",{className:"mt-4 space-y-2 text-sm text-gray-600",children:null===(r=s.features)||void 0===r?void 0:r.slice(0,3).map((e,t)=>(0,m.jsxs)("li",{className:"flex items-center",children:[(0,m.jsx)("span",{className:"text-green-500 mr-2",children:"\u2713"}),e.name]},t))}),(0,m.jsx)("button",{onClick:()=>(async t=>{try{a(!0);const i=await o.A.post("".concat("","/api/subscriptions"),{planId:t},{withCredentials:!0});if(i.data.success){var s,r,l;const{razorpayOrder:t,subscription:n}=i.data.data,d={key:t.key,amount:t.amount,currency:t.currency,name:"Avijo Expert",description:"Subscription Payment",order_id:t.id,handler:async function(e){try{(await o.A.post("".concat("","/api/subscriptions/verify-payment"),{razorpay_order_id:e.razorpay_order_id,razorpay_payment_id:e.razorpay_payment_id,razorpay_signature:e.razorpay_signature},{withCredentials:!0})).data.success?(c.Ay.success("Subscription activated successfully!"),P(),F(),L()):c.Ay.error("Payment verification failed")}catch(s){var t,a;console.error("Payment verification error:",s),c.Ay.error((null===(t=s.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||"Payment verification failed")}},prefill:{name:(null===e||void 0===e?void 0:e.fullName)||(null===e||void 0===e||null===(s=e.personalDetails)||void 0===s?void 0:s.fullName)||"",email:(null===e||void 0===e?void 0:e.emailId)||(null===e||void 0===e||null===(r=e.personalDetails)||void 0===r?void 0:r.emailId)||"",contact:(null===e||void 0===e?void 0:e.mobileNumber)||(null===e||void 0===e||null===(l=e.personalDetails)||void 0===l?void 0:l.mobileNumber)||""},theme:{color:"#0095D9"},modal:{ondismiss:function(){c.Ay.error("Payment cancelled"),a(!1)}}},u=new window.Razorpay(d);u.on("payment.failed",function(e){c.Ay.error("Payment failed: ".concat(e.error.description)),a(!1)}),u.open()}}catch(d){var i,n;console.error("Error creating subscription:",d),c.Ay.error((null===(i=d.response)||void 0===i||null===(n=i.data)||void 0===n?void 0:n.message)||"Failed to create subscription")}finally{a(!1)}})(s._id),className:"w-full mt-4 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",disabled:t,children:"Subscribe"})]},s._id)})}):(0,m.jsx)("p",{className:"text-gray-600 text-sm",children:"No plans available."})]})]}),"payment-methods"===s&&(0,m.jsxs)("div",{className:"border border-gray-200 rounded-lg p-6",children:[(0,m.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,m.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Payment Methods"}),(0,m.jsx)("button",{onClick:()=>w(!N),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 text-sm",children:"Add Payment Method"})]}),v?(0,m.jsx)("div",{className:"text-center py-4",children:"Loading..."}):f.length>0?(0,m.jsx)("div",{className:"space-y-4",children:f.map(e=>(0,m.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 flex justify-between items-center",children:[(0,m.jsx)("div",{className:"flex items-center space-x-4",children:(0,m.jsxs)("div",{children:["card"===e.type&&(0,m.jsxs)("div",{children:[(0,m.jsxs)("p",{className:"font-semibold text-gray-900",children:["\u2022\u2022\u2022\u2022 \u2022\u2022\u2022\u2022 \u2022\u2022\u2022\u2022 ",e.cardLast4]}),(0,m.jsxs)("p",{className:"text-sm text-gray-600",children:[e.cardBrand," \u2022 Expires ",e.cardExpiryMonth,"/",e.cardExpiryYear]})]}),"upi"===e.type&&(0,m.jsxs)("div",{children:[(0,m.jsx)("p",{className:"font-semibold text-gray-900",children:"UPI"}),(0,m.jsx)("p",{className:"text-sm text-gray-600",children:e.upiId})]}),e.isDefault&&(0,m.jsx)("span",{className:"inline-block mt-1 px-2 py-1 text-xs font-semibold rounded bg-blue-100 text-blue-800",children:"Default"})]})}),(0,m.jsxs)("div",{className:"flex space-x-2",children:[!e.isDefault&&(0,m.jsx)("button",{onClick:()=>(async e=>{try{a(!0),(await o.A.put("".concat("","/api/subscriptions/payment-methods/").concat(e,"/set-default"),{},{withCredentials:!0})).data.success&&(c.Ay.success("Default payment method updated"),I())}catch(t){console.error("Error setting default payment method:",t),c.Ay.error("Failed to update default payment method")}finally{a(!1)}})(e._id),className:"px-3 py-1 text-sm text-blue-600 border border-blue-600 rounded hover:bg-blue-50",disabled:t,children:"Set Default"}),(0,m.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this payment method?"))try{a(!0),(await o.A.delete("".concat("","/api/subscriptions/payment-methods/").concat(e),{withCredentials:!0})).data.success&&(c.Ay.success("Payment method deleted successfully"),I())}catch(t){console.error("Error deleting payment method:",t),c.Ay.error("Failed to delete payment method")}finally{a(!1)}})(e._id),className:"px-3 py-1 text-sm text-red-600 border border-red-600 rounded hover:bg-red-50",disabled:t,children:"Delete"})]})]},e._id))}):(0,m.jsx)("p",{className:"text-gray-600 text-sm",children:"You have no saved payment method."}),N&&(0,m.jsx)("div",{className:"mt-4 p-4 border border-gray-200 rounded-lg bg-gray-50",children:(0,m.jsx)("p",{className:"text-sm text-gray-600",children:"Payment methods will be saved automatically after your first successful payment. Complete a subscription payment to add a payment method."})})]}),"billing"===s&&(0,m.jsxs)("div",{className:"space-y-6",children:[D&&(0,m.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[(0,m.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,m.jsx)("p",{className:"text-sm text-gray-600",children:"Total Paid"}),(0,m.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:z(D.totalPaid)})]}),(0,m.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,m.jsx)("p",{className:"text-sm text-gray-600",children:"Active Subscriptions"}),(0,m.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:D.activeSubscriptions})]}),(0,m.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4",children:[(0,m.jsx)("p",{className:"text-sm text-gray-600",children:"Total Invoices"}),(0,m.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:D.totalInvoices})]})]}),(0,m.jsxs)("div",{className:"border border-gray-200 rounded-lg p-6",children:[(0,m.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Billing History"}),C?(0,m.jsx)("div",{className:"text-center py-4",children:"Loading..."}):A.length>0?(0,m.jsx)("div",{className:"space-y-4",children:A.map(e=>{var t;return(0,m.jsx)("div",{className:"border border-gray-200 rounded-lg p-4",children:(0,m.jsxs)("div",{className:"flex justify-between items-start",children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("p",{className:"font-semibold text-gray-900",children:e.invoiceNumber}),(0,m.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:(null===(t=e.planId)||void 0===t?void 0:t.name)||"Subscription Payment"}),(0,m.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:R(e.createdAt)})]}),(0,m.jsxs)("div",{className:"text-right",children:[(0,m.jsx)("p",{className:"font-semibold text-gray-900",children:z(e.totalAmount,e.currency)}),(0,m.jsx)("span",{className:"inline-block mt-1 px-2 py-1 text-xs font-semibold rounded ".concat("paid"===e.status?"bg-green-100 text-green-800":"pending"===e.status?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:e.status.toUpperCase()})]})]})},e._id)})}):(0,m.jsx)("p",{className:"text-gray-600 text-sm",children:"You have no Billing History."})]})]}),(0,m.jsxs)("div",{className:"mt-6 border border-gray-200 rounded-lg p-6",children:[(0,m.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Information and resources"}),(0,m.jsx)("a",{href:"#",className:"text-blue-600 hover:text-blue-800 underline text-sm",children:"Help center"})]})]})}function y(){var e;const{doctor:t,setDoctor:a}=(0,n.S)(),[y,j]=(0,r.useState)(null),[N,w]=(0,r.useState)(""),[A,k]=(0,r.useState)(""),[C,S]=(0,r.useState)(""),[D,E]=(0,r.useState)(""),[P,I]=(0,r.useState)(""),[F,L]=(0,r.useState)(""),[R,z]=(0,r.useState)(""),[q,M]=(0,r.useState)(!0),[_,U]=(0,r.useState)(!1),[B,T]=(0,r.useState)(null),[O,Y]=(0,r.useState)("Edit Profile"),[W,G]=(0,r.useState)(!1),[V,H]=(0,r.useState)({allowSearchEngineIndex:!0,allowAdultContent:!1,allowProfileDiscoveryByEmail:!0,allowLLMTraining:!0,whoCanSendMessage:"followed",allowComments:!0,allowGifsAutoPlay:!0,allowAdvertisersPromote:!0,notifySubscribers:!1}),[J,Q]=(0,r.useState)({theme:"auto",fontSize:""}),[K,Z]=(0,r.useState)({newAnswers:!0,requests:!0,messages:!0,commentsAndReplies:!0,mentions:!0,spaceInvites:!0,spaceUpdates:!0,spacesForYou:!0,newFollowers:!0,upvotes:!0,shares:!0,moderation:!0,docareDigest:!0,digestFrequency:"asAvailable",popularAnswers:!0,storiesBasedOnActivity:!0,recommendedQuestions:!0}),[$,X]=(0,r.useState)("English"),ee=r.useRef(null),te=(0,i.Zp)(),ae=(0,i.zy)();(0,r.useEffect)(()=>{var e;const t=null===(e=ae.state)||void 0===e?void 0:e.activeSection,a=new URLSearchParams(ae.search).get("section");t?Y(t):a&&Y(a)},[ae]);const se=e=>{var t,a,s,r,l,i;if(!e)return null;const n=[e.doctorImage,null===(t=e.personalDetails)||void 0===t?void 0:t.doctorImage,e.image,null===(a=e.personalDetails)||void 0===a?void 0:a.image,e.profileImage,e.avatar,e.profilePicture,null===(s=e.userId)||void 0===s?void 0:s.doctorImage,null===(r=e.userId)||void 0===r?void 0:r.image,null===(l=e.docRefId)||void 0===l?void 0:l.doctorImage,null===(i=e.docRefId)||void 0===i?void 0:i.image];for(const o of n)if(o&&"string"===typeof o&&""!==o.trim()&&"undefined"!==o)return o;return null},re=(0,r.useCallback)(e=>{var t,a,s,r,l,i,n,o;if(!e)return;const c=(null===(t=e.personalDetails)||void 0===t?void 0:t.fullName)||e.fullName||"",d=(null===(a=e.docRefId)||void 0===a?void 0:a.mobileNumber)||e.mobileNumber||(null===(s=e.contactDetails)||void 0===s?void 0:s.mobile)||"",u=e.about||e.bio||"",m=(null===(r=e.systemOfMedicine)||void 0===r?void 0:r.systemOfMedicine)||e.specialization||e.specializations||"",x=[null===(l=e.currentWorkDetails)||void 0===l?void 0:l.workStatus,null===(i=e.currentWorkDetails)||void 0===i?void 0:i.natureOfWork].filter(Boolean).join(" - "),b=(null===(n=e.qualificationDetails)||void 0===n?void 0:n.degreeName)||e.education||e.qualifications||"",h=(null===(o=e.placeOfWork)||void 0===o?void 0:o.facilityName)||e.clinicDetails||e.facilityName||"";w(c),k(d),S(u),E(m),I(x),L(b),z(h),j(t=>{if(t instanceof File)return t;const a=se(e);if(a){return a.includes("?")?a:"".concat(a,"?t=").concat(Date.now())}return null}),T(e=>e||null)},[]),le=(0,r.useRef)(t);(0,r.useEffect)(()=>{le.current=t},[t]),(0,r.useEffect)(()=>{const e=le.current;null!==e&&void 0!==e&&e._id?(async()=>{try{var e;M(!0);const t=null===(e=le.current)||void 0===e?void 0:e._id,r=await o.A.get("".concat("","/doctor/getDoctorProfile/").concat(t),{withCredentials:!0});if(r.data&&r.data.data){const e=r.data.data;a(t=>t?(0,s.A)((0,s.A)((0,s.A)({},t),e),{},{personalDetails:(0,s.A)((0,s.A)({},t.personalDetails),e.personalDetails),docRefId:(0,s.A)((0,s.A)({},t.docRefId),e.docRefId)}):e),re(e)}else u.v.warn("No data in response or unexpected response structure"),le.current&&re(le.current)}catch(t){u.v.error("Error fetching doctor details:",t),le.current&&re(le.current)}finally{M(!1)}})():e?(re(e),M(!1)):(u.v.warn("No doctor data found in store"),M(!1))},[null===t||void 0===t?void 0:t._id,re,a]),(0,r.useEffect)(()=>{!t||q||B||(j(e=>(File,e)),re(t))},[null===t||void 0===t?void 0:t._id,q,re]);(0,r.useEffect)(()=>()=>{B&&URL.revokeObjectURL(B)},[B]);return q?(0,m.jsx)(l.A,{children:(0,m.jsx)("div",{className:"bg-white min-h-screen p-8 flex items-center justify-center",children:(0,m.jsx)("div",{className:"text-lg",children:"Loading profile..."})})}):(0,m.jsx)(l.A,{children:(0,m.jsx)("div",{className:"bg-white min-h-screen",children:(0,m.jsxs)("div",{className:"flex",children:[(0,m.jsxs)("div",{className:"w-64 bg-white border-r border-gray-200 min-h-screen p-6",children:[(0,m.jsx)("button",{onClick:()=>{te(-1)},className:"mb-6 text-gray-600 hover:text-gray-900 font-semibold flex items-center gap-2",children:"\u2190 Back"}),(0,m.jsxs)("div",{className:"mb-8",children:[(0,m.jsx)("h2",{className:"text-sm font-semibold text-gray-500 uppercase tracking-wide mb-4 border-b border-gray-200 pb-2",children:"Profile Settings"}),(0,m.jsx)("div",{className:"space-y-2",children:(0,m.jsx)("button",{onClick:()=>Y("Edit Profile"),className:"w-full text-left px-3 py-2 rounded-md font-medium transition ".concat("Edit Profile"===O?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"),children:"Edit Profile"})})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("h2",{className:"text-sm font-semibold text-gray-500 uppercase tracking-wide mb-4 border-b border-gray-200 pb-2",children:"Settings"}),(0,m.jsxs)("div",{className:"space-y-2",children:[(0,m.jsx)("button",{onClick:()=>Y("Account"),className:"w-full text-left px-3 py-2 rounded-md font-medium transition ".concat("Account"===O?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"),children:"Account"}),(0,m.jsx)("button",{onClick:()=>Y("Privacy"),className:"w-full text-left px-3 py-2 rounded-md font-medium transition ".concat("Privacy"===O?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"),children:"Privacy"}),(0,m.jsx)("button",{onClick:()=>Y("Display"),className:"w-full text-left px-3 py-2 rounded-md font-medium transition ".concat("Display"===O?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"),children:"Display"}),(0,m.jsx)("button",{onClick:()=>Y("Email & Notifications"),className:"w-full text-left px-3 py-2 rounded-md font-medium transition ".concat("Email & Notifications"===O?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"),children:"Email & Notifications"}),(0,m.jsx)("button",{onClick:()=>Y("Languages"),className:"w-full text-left px-3 py-2 rounded-md font-medium transition ".concat("Languages"===O?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"),children:"Languages"}),(0,m.jsx)("button",{onClick:()=>Y("Subscriptions & Billing"),className:"w-full text-left px-3 py-2 rounded-md font-medium transition ".concat("Subscriptions & Billing"===O?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"),children:"Subscriptions & Billing"})]})]})]}),(0,m.jsxs)("div",{className:"flex-1 p-8",children:["Edit Profile"===O&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:"flex justify-end items-center mb-6",children:(0,m.jsx)("button",{onClick:async()=>{try{if(!N.trim())return void c.Ay.error("Display name is required");if(A&&!/^\d{10}$/.test(A.trim()))return void c.Ay.error("Mobile number must be 10 digits");if(""===D.trim()||""===F.trim()||""===R.trim())return void c.Ay.error("Specialization, Education, and Clinic Details are required");const e=null===t||void 0===t?void 0:t._id;if(!e)return void c.Ay.error("Doctor ID not found. Please refresh the page.");const r=d({fullName:N.trim(),mobile:A.trim(),about:C.trim(),specialization:D.trim(),experience:P.trim(),degree:F.trim(),clinicDetails:R.trim()}),l={"Content-Type":"application/json"},i="".concat("","/doctor/doctorProfile/update/").concat(e),n=await o.A.put(i,r,{headers:l,withCredentials:!0});if(200===n.status&&n.data.data){const e=(0,s.A)((0,s.A)({},t),n.data.data);a(e),re(n.data.data),c.Ay.success("Profile updated successfully!")}else c.Ay.error(n.data.message||"Failed to update profile")}catch(e){u.v.error("Error saving profile:",e),e.response?c.Ay.error("Error: ".concat(e.response.data.message||"Failed to update profile")):c.Ay.error("Something went wrong while saving your profile.")}},className:"px-4 py-2 border-[2px] border-[#0097DB] text-[#0097DB] rounded bg-white hover:bg-[#E6F5FB] transition",children:"Save Changes"})}),(0,m.jsx)("div",{className:"flex flex-col md:flex-row border-b pb-6 mt-6",children:(0,m.jsxs)("div",{className:"flex flex-col items-center md:items-start",children:[(0,m.jsxs)("div",{className:"flex items-center gap-4",children:[(0,m.jsxs)("div",{className:"relative",children:[B||y?(0,m.jsx)("img",{id:"profile-preview",src:B||y,alt:"Profile",className:"h-[156px] w-[156px] rounded-full object-cover border border-gray-200",onError:e=>{e.target.style.display="none";const t=e.target.nextElementSibling;t&&(t.style.display="flex")}}):null,(0,m.jsx)("div",{className:"h-[156px] w-[156px] rounded-full border border-gray-200 flex items-center justify-center bg-gradient-to-br from-[#0097DB] to-[#0075a9] text-white text-4xl font-semibold ".concat(B||y?"hidden":""),children:(e=>{if(!e||"string"!==typeof e)return"DR";const t=e.trim().split(/\s+/);return t.length>=2?(t[0][0]+t[t.length-1][0]).toUpperCase():1===t.length&&t[0].length>=2?t[0].substring(0,2).toUpperCase():1===t[0].length?t[0].toUpperCase()+"D":"DR"})(N||(null===t||void 0===t?void 0:t.fullName)||(null===t||void 0===t||null===(e=t.personalDetails)||void 0===e?void 0:e.fullName)||"Doctor")}),(0,m.jsx)("label",{htmlFor:"profile-image-upload",className:"absolute bottom-0 right-0 bg-[#0097DB] text-white rounded-full p-2 cursor-pointer hover:bg-[#0075a9] transition shadow-lg z-10",title:"Change profile image",children:(0,m.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,m.jsx)("path",{fillRule:"evenodd",d:"M4 5a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V7a2 2 0 00-2-2h-1.586a1 1 0 01-.707-.293l-1.121-1.121A2 2 0 0011.172 3H8.828a2 2 0 00-1.414.586L6.293 4.707A1 1 0 015.586 5H4zm6 9a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"})})}),(0,m.jsx)("input",{ref:ee,id:"profile-image-upload",type:"file",accept:"image/*",className:"hidden",onChange:e=>{const t=e.target.files[0];if(!t)return;if(!t.type.startsWith("image/"))return void c.Ay.error("Please select an image file");if(t.size>5242880)return void c.Ay.error("Image size should be less than 5MB");B&&URL.revokeObjectURL(B);const a=URL.createObjectURL(t);T(a),j(t)}})]}),(0,m.jsxs)("div",{className:"flex flex-col items-center md:items-start",children:[(0,m.jsxs)("div",{className:"text-2xl font-semibold",children:["Dr. ",N||(null===t||void 0===t?void 0:t.fullName)||"Doctor Name"]}),y instanceof File&&(0,m.jsx)("button",{onClick:async()=>{if(!(y instanceof File))return void c.Ay.error("Please select an image first");const e=null===t||void 0===t?void 0:t._id;if(e){U(!0);try{const u=new FormData;u.append("doctorImage",y);const h=await o.A.put("".concat("","/doctor/doctorProfile/update/").concat(e),u,{headers:{"Content-Type":"multipart/form-data"},withCredentials:!0});if(200===h.status&&h.data.data){var r,l,i,n,d,m,x,b;const e=(0,s.A)((0,s.A)({},t),h.data.data);a(e),B&&(URL.revokeObjectURL(B),T(null));const o=se(h.data.data);if(o){const e=o.includes("?")?o:"".concat(o,"?t=").concat(Date.now());j(e)}else j(null);const u=h.data.data,p=(null===(r=u.personalDetails)||void 0===r?void 0:r.fullName)||u.fullName||"",g=(null===(l=u.docRefId)||void 0===l?void 0:l.mobileNumber)||u.mobileNumber||(null===(i=u.contactDetails)||void 0===i?void 0:i.mobile)||"",f=u.about||u.bio||"",y=(null===(n=u.systemOfMedicine)||void 0===n?void 0:n.systemOfMedicine)||u.specialization||u.specializations||"",v=[null===(d=u.currentWorkDetails)||void 0===d?void 0:d.workStatus,null===(m=u.currentWorkDetails)||void 0===m?void 0:m.natureOfWork].filter(Boolean).join(" - "),N=(null===(x=u.qualificationDetails)||void 0===x?void 0:x.degreeName)||u.education||u.qualifications||"",A=(null===(b=u.placeOfWork)||void 0===b?void 0:b.facilityName)||u.clinicDetails||u.facilityName||"";w(p),k(g),S(f),E(y),I(v),L(N),z(A),c.Ay.success("Profile image updated successfully!")}else c.Ay.error(h.data.message||"Failed to update profile image")}catch(h){u.v.error("Error updating profile image:",h),h.response?c.Ay.error("Error: ".concat(h.response.data.message||"Failed to update profile image")):c.Ay.error("Something went wrong while uploading the image.")}finally{U(!1),ee.current&&(ee.current.value="")}}else c.Ay.error("Doctor ID not found. Please refresh the page.")},disabled:_,className:"mt-2 px-3 py-1 text-sm bg-[#0097DB] text-white rounded hover:bg-[#0075a9] disabled:opacity-50 disabled:cursor-not-allowed transition",children:_?"Uploading...":"Save Image"})]})]}),(0,m.jsxs)("div",{className:"mt-4 w-full",children:[(0,m.jsx)("label",{className:"text-sm text-gray-500",children:"Display Name"}),(0,m.jsx)("input",{type:"text",value:N,onChange:e=>w(e.target.value),placeholder:"Enter your display name",className:"mt-1 w-full border rounded px-3 py-2 text-sm"})]}),(0,m.jsxs)("div",{className:"mt-4 w-full",children:[(0,m.jsx)("label",{className:"text-sm text-gray-500",children:"Mobile number "}),(0,m.jsx)("input",{type:"text",value:A,onChange:e=>k(e.target.value),placeholder:"Mobile number ",className:"mt-1 w-full border rounded px-3 py-2 text-sm "})]})]})}),(0,m.jsx)(v,{title:"About",value:C,onChange:S}),(0,m.jsx)(v,{title:"Specialization",value:D,onChange:E}),(0,m.jsx)(v,{title:"Experience",value:P,onChange:I}),(0,m.jsx)(v,{title:"Education",value:F,onChange:L}),(0,m.jsx)(v,{title:"Clinic Details",value:R,onChange:z})]}),"Account"===O&&(0,m.jsx)(x,{doctor:t,emailVerificationRequired:W,setEmailVerificationRequired:G}),"Privacy"===O&&(0,m.jsx)(b,{privacySettings:V,setPrivacySettings:H}),"Display"===O&&(0,m.jsx)(h,{displaySettings:J,setDisplaySettings:Q}),"Email & Notifications"===O&&(0,m.jsx)(p,{emailNotifications:K,setEmailNotifications:Z}),"Languages"===O&&(0,m.jsx)(g,{selectedLanguage:$,setSelectedLanguage:X}),"Subscriptions & Billing"===O&&(0,m.jsx)(f,{}),"Edit Profile"!==O&&"Account"!==O&&"Privacy"!==O&&"Display"!==O&&"Email & Notifications"!==O&&"Languages"!==O&&"Subscriptions & Billing"!==O&&(0,m.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[O," settings coming soon..."]})]})]})})})}function v(e){let{title:t,value:a,onChange:s}=e;return(0,m.jsxs)("div",{className:"border-b py-6",children:[(0,m.jsx)("h3",{className:"text-lg font-semibold mb-3",children:t}),(0,m.jsx)("textarea",{value:a||"",onChange:e=>s(e.target.value),className:"w-full border rounded px-3 py-2 text-sm text-gray-600",rows:3,placeholder:"Enter your ".concat(t.toLowerCase())})]})}}}]);