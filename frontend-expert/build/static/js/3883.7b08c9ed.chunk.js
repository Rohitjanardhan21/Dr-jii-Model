(self.webpackChunkclient=self.webpackChunkclient||[]).push([[3883],{20828:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});var o=n(9950),r=n(43302),s=(n(58439),n(44414));const a=function(e){let{patientData:t,setSelectedPatient:n,lockedPatient:a}=e;const[i,l]=(0,o.useState)(""),[d,c]=(0,o.useState)(null),[u,p]=(0,o.useState)(!1),m=(t||[]).filter(e=>{var t;return null===(t=e.fullName)||void 0===t?void 0:t.toLowerCase().includes(i.toLowerCase())});return(0,o.useEffect)(()=>{a&&(c(a),"function"===typeof n&&n(a))},[a]),(0,s.jsx)("div",{className:"w-full rounded-xl px-1",children:(0,s.jsxs)("div",{className:"flex w-full flex-col gap-1",children:[(0,s.jsx)("label",{className:"text-lg mb-2 font-semibold text-black",children:"Patient Name"}),a?(0,s.jsx)("div",{className:"flex items-center h-12 rounded-lg border border-gray-300 px-3 py-1 bg-gray-50",children:(0,s.jsx)("span",{className:"text-sm font-medium text-black",children:a.fullName})}):(0,s.jsxs)("div",{className:"flex items-center h-12 rounded-lg border border-gray-300 px-3 py-1",children:[(0,s.jsx)(r.VxX,{className:"text-gray-400 ml-2",style:{height:"14px",width:"14px"}}),(0,s.jsx)("input",{type:"text",placeholder:"Search Patient",className:"ml-2 w-full border-none text-sm outline-none placeholder:text-sm placeholder:text-gray-400",value:i,onChange:e=>{l(e.target.value),p(!0)}})]}),i&&u&&(0,s.jsx)("div",{className:"custom-scrollbar mt-1 max-h-32 overflow-y-auto rounded-lg border border-gray-200 shadow",children:0===m.length?(0,s.jsx)("p",{className:"p-2 text-xs text-gray-500",children:"No results found"}):m.map(e=>(0,s.jsx)("div",{className:"cursor-pointer p-2 ml-1 text-sm hover:bg-gray-100",onClick:()=>(e=>{c(e),n(e),p(!1),l("")})(e),children:e.fullName},e.id))}),d&&(0,s.jsxs)("div",{className:"mt-3 flex flex-col gap-1",children:[(0,s.jsx)("h6",{className:"text-sm font-medium text-black",children:d.fullName}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:d.email}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:d.mobileNumber})]})]})})}},29373:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>w});var o=n(9950),r=n(17340),s=n(35887),a=n(28429),i=n(42074),l=n(6604),d=n(38613),c=n(50384),u=n(22535),p=n(39174),m=(n(20828),n(61533)),h=n(26678),x=n(31222),f=n(68873),g=n(61426),b=n(45418),v=n(86027),y=n(44414);const w=function(){var e,t,n,w;const{id:j}=(0,a.g)(),[N,k]=(0,o.useState)(null===u.rQ||void 0===u.rQ||null===(e=u.rQ.status[1])||void 0===e?void 0:e.name),[E,S]=(0,o.useState)(null),[P,C]=(0,o.useState)(!0),[A,R]=(0,o.useState)(""),[T,D]=(0,o.useState)([]),[F,M]=(0,o.useState)([]),[L,W]=(0,o.useState)([]),[_,q]=(0,o.useState)(null),[z,I]=(0,o.useState)(0),[O,B]=(0,o.useState)(0),[H,Q]=(0,o.useState)(!1),[U,G]=(0,o.useState)(!1),[V,Y]=(0,o.useState)(null),$=(0,o.useRef)(null),K=(0,a.Zp)();(0,o.useEffect)(()=>{(async()=>{try{const e=await fetch("".concat("","/doctor/unique/patients"),{credentials:"include"}),t=await e.json();M((null===t||void 0===t?void 0:t.patients)||[])}catch(e){console.log("Error fetching unique patients:",e)}})()},[]),(0,o.useEffect)(()=>{(async()=>{try{const e=await fetch("".concat("","/doctor/services"),{credentials:"include"}),t=await e.json();W(t),console.log("Fetched Services:",t)}catch(e){console.log("error fetching...",e)}})()},[]),(0,o.useEffect)(()=>{(async()=>{try{const n=await fetch("".concat("","/doctor/payment/").concat(j),{credentials:"include"}),o=await n.json();if(o.success){var e,t;S(o.data),console.log("Data to preview:",o.data),k(o.data.status),R(o.data.notes||""),q(o.data.patientId),I((null===(e=o.data)||void 0===e?void 0:e.discount)||0),B((null===(t=o.data)||void 0===t?void 0:t.tax)||0);const n=o.data.services.map(e=>({_id:e._id||e.serviceId,serviceName:null===e||void 0===e?void 0:e.name,price:null===e||void 0===e?void 0:e.price,quantity:null===e||void 0===e?void 0:e.quantity}));console.log("editable"),D(n)}else s.oR.error("Payment not found")}catch(n){s.oR.error("Failed to fetch payment"),console.error(n)}finally{C(!1)}})()},[j]);const J="\n@media print {\n  body {\n    margin: 0;\n    padding: 0;\n  }\n\n  body * {\n    visibility: hidden;\n  }\n\n  .not-printable-content, .not-printable-content * {\n    visibility: hidden;\n    display: none !important; \n  }\n\n  .printable-content, .printable-content * {\n    visibility: visible;\n  }\n\n  .printable-content {\n    margin: 0 !important;\n    padding: 10px !important;\n    box-sizing: border-box;\n    page-break-inside: avoid !important;\n    break-inside: avoid !important;\n    width: 100% !important;\n    max-width: none !important;\n    height: auto !important;\n    overflow: visible !important;\n    display: block !important;\n    transform: none !important;\n    font-size: 10px !important;\n    line-height: 1.2 !important;\n  }\n\n  /* Force single page layout */\n  .printable-content {\n    max-height: 297mm !important; /* A4 height */\n    overflow: hidden !important;\n  }\n\n  .avoid-break, .avoid-break * {\n    page-break-inside: avoid !important;\n    break-inside: avoid !important;\n  }\n\n  .no-scroll-on-print {\n    overflow: visible !important;\n  }\n\n  .invoice-header, .invoice-main, table, tr, td, th {\n    page-break-inside: avoid !important;\n  }\n\n  .overflow-x-scroll {\n    overflow: visible !important;\n  }\n\n  /* Grid and flex layout adjustments for print */\n  .print-grid-layout {\n    display: block !important;\n    width: 100% !important;\n    gap: 5px !important;\n    margin: 0 !important;\n  }\n\n  .flex-rows {\n    flex-wrap: wrap !important;\n    gap: 5px !important;\n  }\n\n  /* Reduce all spacing */\n  .p-5, .p-4, .p-3, .p-2, .p-1 {\n    padding: 5px !important;\n  }\n\n  .px-6, .px-5, .px-4, .px-3, .px-2, .px-1 {\n    padding-left: 5px !important;\n    padding-right: 5px !important;\n  }\n\n  .py-4, .py-3, .py-2, .py-1 {\n    padding-top: 3px !important;\n    padding-bottom: 3px !important;\n  }\n\n  .mb-4, .mb-3, .mb-2, .mb-1 {\n    margin-bottom: 5px !important;\n  }\n\n  .mt-4, .mt-3, .mt-2, .mt-1 {\n    margin-top: 5px !important;\n  }\n\n  .gap-4, .gap-3, .gap-2, .gap-1 {\n    gap: 5px !important;\n  }\n\n  /* Table adjustments for single page */\n  table {\n    width: 100% !important;\n    table-layout: fixed !important;\n    page-break-inside: avoid !important;\n    font-size: 9px !important;\n    margin: 0 !important;\n  }\n\n  th, td {\n    padding: 3px !important;\n    white-space: normal !important;\n    word-wrap: break-word !important;\n    overflow-wrap: break-word !important;\n    font-size: 9px !important;\n    line-height: 1.1 !important;\n  }\n\n  /* Reduce font sizes */\n  .text-xl { font-size: 14px !important; }\n  .text-lg { font-size: 12px !important; }\n  .text-md { font-size: 11px !important; }\n  .text-sm { font-size: 10px !important; }\n  .text-xs { font-size: 9px !important; }\n\n  /* Header adjustments */\n  h1, h2, h3, h4, h5, h6 {\n    margin: 5px 0 !important;\n    line-height: 1.2 !important;\n  }\n\n  /* Remove unnecessary spacing */\n  .border, .border-1, .border-2 {\n    border-width: 1px !important;\n  }\n\n  .rounded-xl, .rounded-lg, .rounded-md {\n    border-radius: 3px !important;\n  }\n\n  @page {\n    size: A4 portrait;\n    margin: 5mm;\n  }\n\n  @media print and (orientation: landscape) {\n    .printable-content {\n      width: 1122px; /* A4 width in landscape at 96 DPI */\n      max-height: 210mm !important; /* A4 height in landscape */\n    }\n  }\n\n  @media print and (orientation: portrait) {\n    .printable-content {\n      width: 794px; /* A4 width in portrait at 96 DPI */\n      max-height: 297mm !important; /* A4 height in portrait */\n    }\n  }\n}\n",X=(0,b.useReactToPrint)({contentRef:$,documentTitle:"Invoice-".concat((null===E||void 0===E?void 0:E._id)||"payment"),pageStyle:J,onAfterPrint:()=>s.oR.success("Printed successfully!"),onPrintError:e=>{console.error("Print error:",e),s.oR.error("Print failed")}});if(P)return(0,y.jsx)(r.A,{children:(0,y.jsx)("p",{children:"Loading..."})});if(!E)return(0,y.jsx)(r.A,{children:(0,y.jsx)("p",{children:"Payment not found"})});const Z=null===T||void 0===T?void 0:T.reduce((e,t)=>e+(Number(null===t||void 0===t?void 0:t.price)||0)*(Number(null===t||void 0===t?void 0:t.quantity)||0),0),ee=Z*z/100,te=Z*O/100,ne=Z-ee+te,oe=[{label:"Paid By:",value:(null===_||void 0===_?void 0:_.fullName)||"N/A"},{label:"Currency:",value:null===E||void 0===E?void 0:E.currency},{label:"Sub Total:",value:Z.toFixed(2)},{label:"Discount:",value:"".concat(ee.toFixed(2))},{label:"Tax:",value:"".concat(te.toFixed(2))},{label:"Grand Total:",value:ne.toFixed(2)}],re="bg-subMain flex-rows gap-3 bg-opacity-5 text-subMain rounded-lg border border-subMain border-dashed px-4 py-3 text-sm";return(0,y.jsxs)(r.A,{children:[(0,y.jsx)("style",{children:J}),H&&(0,y.jsx)(g.A,{isOpen:H,closeModal:()=>{Q(!1)},file:V,patient:_,id:j}),U&&(0,y.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,y.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-50 transition-opacity",onClick:()=>G(!1)}),(0,y.jsxs)("div",{className:"relative mx-4 w-full max-w-md transform rounded-lg bg-white p-6 shadow-xl transition-all",children:[(0,y.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,y.jsxs)("div",{className:"flex items-center gap-3",children:[(0,y.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-red-100",children:(0,y.jsx)(f.jDV,{className:"h-6 w-6 text-red-600"})}),(0,y.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Delete Payment"})]}),(0,y.jsx)("button",{onClick:()=>G(!1),className:"rounded-lg p-1 text-gray-400 hover:bg-gray-100 hover:text-gray-600",children:(0,y.jsx)(h.Qks,{className:"h-5 w-5"})})]}),(0,y.jsx)("div",{className:"mb-6",children:(0,y.jsx)("p",{className:"text-sm text-gray-600",children:"Are you sure you want to delete this payment? This action cannot be undone and will permanently remove all associated data."})}),(0,y.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,y.jsx)("button",{onClick:()=>G(!1),className:"rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2",children:"Cancel"}),(0,y.jsxs)("button",{onClick:async()=>{try{const e=await fetch("".concat("","/doctor/payment/").concat(E._id),{method:"DELETE",credentials:"include"}),t=await e.json();t.success?(s.oR.success("Payment deleted successfully"),K("/payments")):s.oR.error(t.message||"Failed to delete payment")}catch(e){console.error("Delete error:",e),s.oR.error("Something went wrong")}finally{G(!1)}},className:"flex items-center gap-2 rounded-lg bg-red-600 px-4 py-2 text-sm font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2",children:[(0,y.jsx)(h.Ku6,{className:"h-4 w-4"}),"Delete"]})]})]})]}),(0,y.jsxs)("div",{className:"flex-btn flex-wrap gap-4",children:[(0,y.jsxs)("div",{className:"no-print flex items-center gap-4",children:[(0,y.jsx)(i.N_,{to:"/payments",className:"text-md rounded-lg border border-dashed border-subMain bg-white px-4 py-3",children:(0,y.jsx)(l.$jz,{})}),(0,y.jsx)("h1",{className:"text-xl font-semibold",children:"Payment"})]}),(0,y.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,y.jsxs)("button",{onClick:async()=>{if($.current){s.oR.loading("Preparing PDF...");try{const e=await(0,v.Q)($.current);if(!e)return s.oR.dismiss(),void s.oR.error("Failed to generate PDF");Y(e),Q(!0),s.oR.dismiss()}catch(e){s.oR.dismiss(),s.oR.error("Failed to generate PDF")}}else s.oR.error("Nothing to share!")},className:re,children:["Share ",(0,y.jsx)(h.eFr,{})]}),(0,y.jsxs)("button",{onClick:()=>{(0,v.E)($.current,"invoice_".concat((null===E||void 0===E?void 0:E._id)||"preview",".pdf"),()=>s.oR.loading("Download starting..."),()=>{s.oR.dismiss(),s.oR.success("Successfully downloaded!")})},className:re,children:["Download ",(0,y.jsx)(x.Hm5,{})]}),(0,y.jsxs)("button",{onClick:()=>{$.current?X():s.oR.error("Nothing to print!")},className:re,children:["Print ",(0,y.jsx)(f.dMs,{})]})]}),(0,y.jsx)("div",{className:"printable-content letter-container invoice-main printable-content avoid-break my-3 rounded-xl border-[1px] border-border bg-white p-5",ref:$,"data-aos":"fade-up","data-aos-duration":"1000","data-aos-delay":"100","data-aos-offset":"200",children:(0,y.jsxs)("div",{className:"avoid-break",children:[(0,y.jsx)("div",{className:"avoid-break grid grid-cols-1 items-center gap-2 sm:grid-cols-2 lg:grid-cols-4",children:(0,y.jsxs)("div",{className:"avoid-break col-span-4 flex w-full justify-between",children:[(0,y.jsxs)("div",{className:"avoid-break flex flex-col gap-2 sm:items-start",children:[(0,y.jsxs)("div",{className:"flex gap-2",children:[(0,y.jsx)("p",{className:"w-20 text-sm font-extralight",children:"Name:"}),(0,y.jsx)("h6",{className:"text-xs font-medium",children:null===_||void 0===_?void 0:_.fullName})]}),(0,y.jsxs)("div",{className:"flex gap-2",children:[(0,y.jsx)("p",{className:"w-20 text-sm font-extralight",children:"Email:"}),(0,y.jsx)("h6",{className:"text-xs font-medium",children:null===_||void 0===_||null===(t=_.contactDetails)||void 0===t?void 0:t.email})]}),(0,y.jsxs)("div",{className:"flex gap-2",children:[(0,y.jsx)("p",{className:"w-20 text-sm font-extralight",children:"Contact:"}),(0,y.jsx)("h6",{className:"text-xs font-medium",children:(null===_||void 0===_||null===(n=_.contactDetails)||void 0===n?void 0:n.primaryContact)||(null===_||void 0===_||null===(w=_.contactDetails)||void 0===w?void 0:w.secondaryContact)})]})]}),(0,y.jsxs)("div",{className:"avoid-break flex flex-col gap-2 sm:items-end",children:[(0,y.jsxs)("h6",{className:"text-xs font-medium",children:["#",E._id]}),(0,y.jsxs)("div",{className:"flex gap-4",children:[(0,y.jsx)("p",{className:"text-sm font-extralight",children:"Date:"}),(0,y.jsx)("h6",{className:"text-xs font-medium",children:new Date(E.createdAt).toLocaleDateString()})]}),(0,y.jsxs)("div",{className:"flex gap-4",children:[(0,y.jsx)("p",{className:"text-sm font-extralight",children:"Due Date:"}),(0,y.jsx)("h6",{className:"text-xs font-medium",children:new Date(E.endDate).toLocaleDateString()})]})]})]})}),(0,y.jsx)("div",{className:"invoice-section",children:(0,y.jsxs)("div",{className:"avoid-break print-grid-layout mt-4 flex flex-col items-stretch gap-4 lg:flex-row",children:[(0,y.jsx)("div",{className:"col-span-6 w-[91%] lg:col-span-5",children:(0,y.jsxs)("div",{className:"avoid-break w-full rounded-xl border border-border p-6",children:[(0,y.jsxs)("div",{className:"not-printable-content mb-4 w-full",children:[(0,y.jsx)("p",{className:"mb-3 text-sm font-bold",children:"Change Status"}),(0,y.jsx)(d.l6,{selectedPerson:N,setSelectedPerson:k,datas:null===u.rQ||void 0===u.rQ?void 0:u.rQ.status,children:(0,y.jsxs)("div",{className:"flex h-14 w-full items-center justify-between rounded-md border border-border px-4 text-xs text-main",children:[(0,y.jsx)("p",{children:N}),(0,y.jsx)(p.nwe,{className:"text-xl"})]})})]}),(0,y.jsx)("div",{className:"not-printable-content",children:(0,y.jsx)(d.TM,{label:"Notes",placeholder:"Thank you for your business. We hope to work with you again soon!",color:!0,rows:3,value:A,onChange:e=>R(e.target.value)})}),(0,y.jsx)(m.Ss,{data:T,setData:D,servicesData:L,currency:null===E||void 0===E?void 0:E.currency}),(0,y.jsxs)("div",{className:"not-printable-content mt-4 flex items-center justify-between gap-4",children:[(0,y.jsxs)("button",{onClick:()=>D(e=>[...e,{_id:"temp_".concat(Date.now()),serviceName:"",price:0,quantity:1}]),className:"flex-rows flex-1 gap-2 rounded-lg border border-dashed border-subMain py-4 text-sm text-subMain",children:[(0,y.jsx)(p.Ca6,{})," Add Order or Service"]}),(0,y.jsxs)("button",{onClick:()=>G(!0),className:"flex-rows gap-2 rounded-lg border border-dashed border-red-500 bg-red-500 bg-opacity-5 px-4 py-4 text-sm text-red-500 transition-colors hover:bg-opacity-10",children:[(0,y.jsx)(h.Ku6,{})," Delete Payment"]})]})]})}),(0,y.jsxs)("div",{className:"avoid-break mb-2 flex flex-col justify-between gap-4 lg:w-[30%]",children:[(0,y.jsxs)("div",{className:"flex w-full flex-col gap-1.5 p-2",children:[(0,y.jsxs)("div",{className:"w-full text-base",children:[(0,y.jsx)("label",{className:"font-semibold text-black",children:"Discount"}),(0,y.jsx)("input",{type:"number",value:z,min:0,max:100,onChange:e=>I(Number(e.target.value)),placeholder:"Enter discount",className:"mt-2 w-full rounded-lg border border-border bg-transparent p-2 text-base font-semibold placeholder-gray-400 focus:border focus:border-subMain"})]}),(0,y.jsxs)("div",{className:"w-full text-base",children:[(0,y.jsx)("label",{className:"font-semibold text-black",children:"Tax (%)"}),(0,y.jsx)("input",{type:"number",value:O,min:0,max:100,onChange:e=>B(Number(e.target.value)),placeholder:"Enter tax percentage",className:"mt-2 w-full rounded-lg border border-border bg-transparent p-2 text-base font-semibold placeholder-gray-400 focus:border focus:border-subMain"})]})]}),(0,y.jsxs)("div",{className:"flex w-full flex-col gap-3 rounded-xl border border-border p-4",children:[oe.map((e,t,n)=>(0,y.jsxs)("div",{className:"flex-btn gap-4",children:[(0,y.jsx)("p",{className:"text-sm font-extralight",children:e.label}),(0,y.jsx)("h6",{className:"text-sm font-medium ".concat(t===n.length-1?"text-green-600":""),children:e.value})]},t)),(0,y.jsx)("div",{className:"not-printable-content",children:(0,y.jsx)(d.$n,{label:"Update",onClick:async()=>{try{const e=T.map(e=>{const t=/^[0-9a-fA-F]{24}$/.test(e._id),n=e._id.startsWith("temp_"),o={quantity:e.quantity,name:e.serviceName,price:e.price};return t&&!n&&(o.serviceId=e._id),o}),t={status:N,notes:A,method:(null===E||void 0===E?void 0:E.method)||"Cash",discount:z,tax:O,amount:ne,services:e};console.log("Update Payment Body:",t);const n=await fetch("".concat("","/doctor/payment/").concat(j),{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)}),o=await n.json();o.success?(s.oR.success("Payment updated successfully"),S(o.data),K("/payments")):s.oR.error(o.message||"Update failed")}catch(e){console.error("Update Error:",e),s.oR.error("Failed to update payment")}},Icon:c.B07})})]})]})]})})]})})]})]})}},45418:function(e,t,n){var o;"undefined"!=typeof self&&self,e.exports=(o=n(9950),function(){"use strict";var e={155:function(e){e.exports=o}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var s=t[o]={exports:{}};return e[o](s,s.exports,n),s.exports}n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};n.r(r),n.d(r,{useReactToPrint:function(){return h}});var s=n(155);function a(e){let{level:t="error",messages:n,suppressErrors:o=!1}=e;o||("error"===t?console.error(n):"warning"===t?console.warn(n):console.debug(n))}function i(e,t){if(t||!e){const e=document.getElementById("printWindow");e&&document.body.removeChild(e)}}function l(e){return e instanceof Error?e:new Error("Unknown Error")}function d(e,t){const{documentTitle:n,onAfterPrint:o,onPrintError:r,preserveAfterPrint:s,print:d,suppressErrors:c}=t;setTimeout(()=>{var t,u;if(e.contentWindow){function p(){null==o||o(),i(s)}if(e.contentWindow.focus(),d)d(e).then(p).catch(e=>{r?r("print",l(e)):a({messages:["An error was thrown by the specified `print` function"],suppressErrors:c})});else{if(e.contentWindow.print){const m=null!==(u=null===(t=e.contentDocument)||void 0===t?void 0:t.title)&&void 0!==u?u:"",h=e.ownerDocument.title;n&&(e.ownerDocument.title=n,e.contentDocument&&(e.contentDocument.title=n)),e.contentWindow.print(),n&&(e.ownerDocument.title=h,e.contentDocument&&(e.contentDocument.title=m))}else a({messages:["Printing for this browser is not currently possible: the browser does not have a `print` method available for iframes."],suppressErrors:c});[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i].some(e=>{var t,n;return(null!==(n=null!==(t=navigator.userAgent)&&void 0!==t?t:navigator.vendor)&&void 0!==n?n:"opera"in window&&window.opera).match(e)})?setTimeout(p,500):p()}}else a({messages:["Printing failed because the `contentWindow` of the print iframe did not load. This is possibly an error with `react-to-print`. Please file an issue: https://github.com/MatthewHerbst/react-to-print/issues/"],suppressErrors:c})},500)}function c(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,null);let o=n.nextNode();for(;o;)t.push(o),o=n.nextNode();return t}function u(e,t,n){const o=c(e),r=c(t);if(o.length===r.length)for(let s=0;s<o.length;s++){const e=o[s],t=r[s],a=e.shadowRoot;if(null!==a){const e=t.attachShadow({mode:a.mode});e.innerHTML=a.innerHTML,u(a,e,n)}}else a({messages:["When cloning shadow root content, source and target elements have different size. `onBeforePrint` likely resolved too early.",e,t],suppressErrors:n})}const p='\n    @page {\n        /* Remove browser default header (title) and footer (url) */\n        margin: 0;\n    }\n    @media print {\n        body {\n            /* Tell browsers to print background colors */\n            color-adjust: exact; /* Firefox. This is an older version of "print-color-adjust" */\n            print-color-adjust: exact; /* Firefox/Safari */\n            -webkit-print-color-adjust: exact; /* Chrome/Safari/Edge/Opera */\n        }\n    }\n';function m(e,t,n,o){var r,s,i,c,m;const{contentNode:h,clonedContentNode:x,clonedImgNodes:f,clonedVideoNodes:g,numResourcesToLoad:b,originalCanvasNodes:v}=n,{bodyClass:y,fonts:w,ignoreGlobalStyles:j,pageStyle:N,nonce:k,suppressErrors:E,copyShadowRoots:S}=o;e.onload=null;const P=null!==(r=e.contentDocument)&&void 0!==r?r:null===(s=e.contentWindow)||void 0===s?void 0:s.document;if(P){const n=P.body.appendChild(x);S&&u(h,n,!!E),w&&((null===(i=e.contentDocument)||void 0===i?void 0:i.fonts)&&(null===(c=e.contentWindow)||void 0===c?void 0:c.FontFace)?w.forEach(n=>{const o=new FontFace(n.family,n.source,{weight:n.weight,style:n.style});e.contentDocument.fonts.add(o),o.loaded.then(()=>{t(o)}).catch(e=>{t(o,["Failed loading the font:",o,"Load error:",l(e)])})}):(w.forEach(e=>{t(e)}),a({messages:['"react-to-print" is not able to load custom fonts because the browser does not support the FontFace API but will continue attempting to print the page'],suppressErrors:E})));const o=null!=N?N:p,r=P.createElement("style");k&&(r.setAttribute("nonce",k),P.head.setAttribute("nonce",k)),r.appendChild(P.createTextNode(o)),P.head.appendChild(r),y&&P.body.classList.add(...y.split(" "));const s=P.querySelectorAll("canvas");for(let e=0;e<v.length;++e){const t=v[e],n=s[e];if(void 0===n){a({messages:["A canvas element could not be copied for printing, has it loaded? `onBeforePrint` likely resolved too early.",t],suppressErrors:E});continue}const o=n.getContext("2d");o&&o.drawImage(t,0,0)}for(let e=0;e<f.length;e++){const n=f[e],o=n.getAttribute("src");if(o){const e=new Image;e.onload=()=>{t(n)},e.onerror=(e,o,r,s,a)=>{t(n,["Error loading <img>",n,"Error",a])},e.src=o}else t(n,['Found an <img> tag with an empty "src" attribute. This prevents pre-loading it.',n])}for(let e=0;e<g.length;e++){const n=g[e];n.preload="auto";const o=n.getAttribute("poster");if(o){const e=new Image;e.onload=()=>{t(n)},e.onerror=(e,r,s,a,i)=>{t(n,["Error loading video poster",o,"for video",n,"Error:",i])},e.src=o}else n.readyState>=2?t(n):n.src?(n.onloadeddata=()=>{t(n)},n.onerror=(e,o,r,s,a)=>{t(n,["Error loading video",n,"Error",a])},n.onstalled=()=>{t(n,["Loading video stalled, skipping",n])}):t(n,["Error loading video, `src` is empty",n])}const d="select",b=h.querySelectorAll(d),C=P.querySelectorAll(d);for(let e=0;e<b.length;e++)C[e].value=b[e].value;if(!j){const n=document.querySelectorAll("style, link[rel~='stylesheet'], link[as='style']");for(let o=0,r=n.length;o<r;++o){const r=n[o];if("style"===r.tagName.toLowerCase()){const t=P.createElement(r.tagName),n=r.sheet;if(n){let s="";try{const e=n.cssRules.length;for(let t=0;t<e;++t)"string"==typeof n.cssRules[t].cssText&&(s+="".concat(n.cssRules[t].cssText,"\r\n"))}catch(e){a({messages:["A stylesheet could not be accessed. This is likely due to the stylesheet having cross-origin imports, and many browsers block script access to cross-origin stylesheets. See https://github.com/MatthewHerbst/react-to-print/issues/429 for details. You may be able to load the sheet by both marking the stylesheet with the cross `crossorigin` attribute, and setting the `Access-Control-Allow-Origin` header on the server serving the stylesheet. Alternatively, host the stylesheet on your domain to avoid this issue entirely.",r,"Original error: ".concat(l(e).message)],level:"warning"})}t.setAttribute("id","react-to-print-".concat(o)),k&&t.setAttribute("nonce",k),t.appendChild(P.createTextNode(s)),P.head.appendChild(t)}}else if(r.getAttribute("href"))if(r.hasAttribute("disabled"))a({messages:["`react-to-print` encountered a <link> tag with a `disabled` attribute and will ignore it. Note that the `disabled` attribute is deprecated, and some browsers ignore it. You should stop using it. https://developer.mozilla.org/en-US/docs/Web/HTML/Element/link#attr-disabled. The <link> is:",r],level:"warning"}),t(r);else{const e=P.createElement(r.tagName);for(let t=0,n=r.attributes.length;t<n;++t){const n=r.attributes[t];n&&e.setAttribute(n.nodeName,null!==(m=n.nodeValue)&&void 0!==m?m:"")}e.onload=()=>{t(e)},e.onerror=(n,o,r,s,a)=>{t(e,["Failed to load",e,"Error:",a])},k&&e.setAttribute("nonce",k),P.head.appendChild(e)}else a({messages:["`react-to-print` encountered a <link> tag with an empty `href` attribute. In addition to being invalid HTML, this can cause problems in many browsers, and so the <link> was not loaded. The <link> is:",r],level:"warning"}),t(r)}}}0===b&&d(e,o)}function h(e){let{bodyClass:t,contentRef:n,copyShadowRoots:o,documentTitle:r,fonts:c,ignoreGlobalStyles:u,nonce:p,onAfterPrint:h,onBeforePrint:x,onPrintError:f,pageStyle:g,preserveAfterPrint:b,print:v,suppressErrors:y}=e;return(0,s.useCallback)(e=>{function s(){const s={bodyClass:t,contentRef:n,copyShadowRoots:o,documentTitle:r,fonts:c,ignoreGlobalStyles:u,nonce:p,onAfterPrint:h,onBeforePrint:x,onPrintError:f,pageStyle:g,preserveAfterPrint:b,print:v,suppressErrors:y},i=function(){const e=document.createElement("iframe");return e.width="".concat(document.documentElement.clientWidth,"px"),e.height="".concat(document.documentElement.clientHeight,"px"),e.style.position="absolute",e.style.top="-".concat(document.documentElement.clientHeight+100,"px"),e.style.left="-".concat(document.documentElement.clientWidth+100,"px"),e.id="printWindow",e.srcdoc="<!DOCTYPE html>",e}(),l=function(e,t){const{contentRef:n,fonts:o,ignoreGlobalStyles:r,suppressErrors:s}=t,i=function(e){let{contentRef:t,optionalContent:n,suppressErrors:o}=e;return n&&"function"==typeof n?(t&&a({level:"warning",messages:['"react-to-print" received a `contentRef` option and an optional-content param passed to its callback. The `contentRef` option will be ignored.']}),n()):t?t.current:void a({messages:['"react-to-print" did not receive a `contentRef` option or a optional-content param pass to its callback.'],suppressErrors:o})}({contentRef:n,optionalContent:e,suppressErrors:s});if(!i)return;const l=i.cloneNode(!0),d=document.querySelectorAll("link[rel~='stylesheet'], link[as='style']"),c=l.querySelectorAll("img"),u=l.querySelectorAll("video"),p=o?o.length:0;return{contentNode:i,clonedContentNode:l,clonedImgNodes:c,clonedVideoNodes:u,numResourcesToLoad:(r?0:d.length)+c.length+u.length+p,originalCanvasNodes:i.querySelectorAll("canvas")}}(e,s);if(!l)return void a({messages:["There is nothing to print"],suppressErrors:y});const w=function(e,t,n){const{suppressErrors:o}=e,r=[],s=[];return function(i,l){r.includes(i)?a({level:"debug",messages:["Tried to mark a resource that has already been handled",i],suppressErrors:o}):(l?(a({messages:['"react-to-print" was unable to load a resource but will continue attempting to print the page',...l],suppressErrors:o}),s.push(i)):r.push(i),r.length+s.length===t&&d(n,e))}}(s,l.numResourcesToLoad,i);!function(e,t,n,o){e.onload=()=>{m(e,t,n,o)},document.body.appendChild(e)}(i,w,l,s)}i(b,!0),x?x().then(()=>{s()}).catch(e=>{null==f||f("onBeforePrint",l(e))}):s()},[t,n,o,r,c,u,p,h,x,f,g,b,v,y])}return r}())}}]);