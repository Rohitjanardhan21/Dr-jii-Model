"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[3719],{17945:(e,t,l)=>{l.d(t,{A:()=>o});var s=l(89379),a=l(9950),r=l(58644),n=l(39174),i=l(14176),c=l(38613),d=l(44414);const o=function(e){let{setItemOpen:t,isOpen:l,servicesData:o,setSelectedService:x,selectedService:m}=e;const[u,h]=(0,a.useState)(!1),[f,p]=(0,a.useState)({serviceName:"",price:""}),[v,b]=(0,a.useState)(1),N=[{title:"Service Name",value:null===f||void 0===f?void 0:f.serviceName,color:!1},{title:"Item Price",value:"$ ".concat(null===f||void 0===f?void 0:f.price),color:!1},{title:"Quantity",value:v,color:!1},{title:"Total",value:"$ ".concat(((null===f||void 0===f?void 0:f.price)*v).toFixed(2)),color:!0}],g=()=>{t(!1),x([...m,(0,s.A)((0,s.A)({},f),{},{quantity:v})]),p({serviceName:"",price:""}),b(1)};return(0,d.jsxs)(d.Fragment,{children:[u&&(0,d.jsx)(i.A,{setOpen:h,patientData:o,isOpen:u,patient:!1,setPatient:p}),(0,d.jsx)(r.A,{closeModal:g,isOpen:l,title:"Add Item",width:"max-w-xl",children:(0,d.jsxs)("div",{className:"flex-colo gap-6",children:[(0,d.jsxs)("div",{className:"flex w-full flex-col gap-4",children:[(0,d.jsx)("p",{className:"text-sm text-black",children:"Service"}),(0,d.jsxs)("button",{onClick:()=>h(!u),className:"flex-rows w-full gap-2 rounded-lg border border-dashed border-subMain py-4 text-sm text-subMain",children:[(0,d.jsx)(n.Ca6,{})," Add Item"]})]}),(0,d.jsx)(c.pd,{label:"Quantity",value:v,onChange:e=>{b(e.target.value)},color:!0,type:"number"}),(0,d.jsxs)("div",{className:"flex w-full flex-col gap-4",children:[(0,d.jsx)("p",{className:"text-sm text-black",children:"Summary"}),(0,d.jsx)("div",{className:"flex flex-col gap-4",children:N.map((e,t)=>(0,d.jsxs)("div",{className:"flex flex-row items-center justify-between",children:[(0,d.jsx)("p",{className:"text-xs text-textGray",children:e.title}),(0,d.jsx)("p",{className:e.color?"rounded-full bg-subMain bg-opacity-10 px-4 py-1 text-xs font-semibold text-subMain":"text-sm font-medium text-textGray",children:e.value})]},t))})]}),(0,d.jsx)(c.$n,{onClick:g,label:"Add",Icon:n.Ca6})]})})]})}},20828:(e,t,l)=>{l.d(t,{A:()=>n});var s=l(9950),a=l(43302),r=(l(58439),l(44414));const n=function(e){let{patientData:t,setSelectedPatient:l,lockedPatient:n}=e;const[i,c]=(0,s.useState)(""),[d,o]=(0,s.useState)(null),[x,m]=(0,s.useState)(!1),u=(t||[]).filter(e=>{var t;return null===(t=e.fullName)||void 0===t?void 0:t.toLowerCase().includes(i.toLowerCase())});return(0,s.useEffect)(()=>{n&&(o(n),"function"===typeof l&&l(n))},[n]),(0,r.jsx)("div",{className:"w-full rounded-xl px-1",children:(0,r.jsxs)("div",{className:"flex w-full flex-col gap-1",children:[(0,r.jsx)("label",{className:"text-lg mb-2 font-semibold text-black",children:"Patient Name"}),n?(0,r.jsx)("div",{className:"flex items-center h-12 rounded-lg border border-gray-300 px-3 py-1 bg-gray-50",children:(0,r.jsx)("span",{className:"text-sm font-medium text-black",children:n.fullName})}):(0,r.jsxs)("div",{className:"flex items-center h-12 rounded-lg border border-gray-300 px-3 py-1",children:[(0,r.jsx)(a.VxX,{className:"text-gray-400 ml-2",style:{height:"14px",width:"14px"}}),(0,r.jsx)("input",{type:"text",placeholder:"Search Patient",className:"ml-2 w-full border-none text-sm outline-none placeholder:text-sm placeholder:text-gray-400",value:i,onChange:e=>{c(e.target.value),m(!0)}})]}),i&&x&&(0,r.jsx)("div",{className:"custom-scrollbar mt-1 max-h-32 overflow-y-auto rounded-lg border border-gray-200 shadow",children:0===u.length?(0,r.jsx)("p",{className:"p-2 text-xs text-gray-500",children:"No results found"}):u.map(e=>(0,r.jsx)("div",{className:"cursor-pointer p-2 ml-1 text-sm hover:bg-gray-100",onClick:()=>(e=>{o(e),l(e),m(!1),c("")})(e),children:e.fullName},e.id))}),d&&(0,r.jsxs)("div",{className:"mt-3 flex flex-col gap-1",children:[(0,r.jsx)("h6",{className:"text-sm font-medium text-black",children:d.fullName}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:d.email}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:d.mobileNumber})]})]})})}},73719:(e,t,l)=>{l.r(t),l.d(t,{default:()=>u});var s=l(9950),a=l(38613),r=l(39174),n=(l(14176),l(17945),l(22535)),i=l(35887),c=l(50384),d=l(28429),o=l(61533),x=(l(20828),l(43302)),m=l(44414);const u=function(e){var t,l,u,h,f,p;let{closeModal:v,onSuccess:b,defaultPatient:N}=e;const[g,j]=(0,s.useState)([new Date,new Date((new Date).setDate((new Date).getDate()+7))]),[y,w]=g,[S,k]=(0,s.useState)(!1),[C,D]=(0,s.useState)(!1),[P,A]=(0,s.useState)(null===(t=n.rQ.currency[4])||void 0===t?void 0:t.name),[Q,_]=(0,s.useState)([]),[I,O]=(0,s.useState)(N||{fullName:"",id:""}),[T,M]=(0,s.useState)([]),[q,E]=(0,s.useState)([{_id:Date.now().toString(),serviceName:"",price:0,quantity:1}]),[F,L]=(0,s.useState)(0),[z,G]=(0,s.useState)(0),[U,$]=(0,s.useState)(""),[R,V]=(0,s.useState)((null===n.rQ||void 0===n.rQ||null===(l=n.rQ.method)||void 0===l||null===(u=l[1])||void 0===u?void 0:u.name)||"Cash"),[X,B]=(0,s.useState)(""),[J,W]=(0,s.useState)(null),[Z,H]=(0,s.useState)(!1),K=q.reduce((e,t)=>e+(t.price*t.quantity||1),0);(0,d.Zp)(),(0,s.useEffect)(()=>{(async()=>{try{const e=await fetch("".concat("","/doctor/services"),{credentials:"include"}),t=await e.json();M(t),console.log("Fetched Services:",t)}catch(e){console.log("error fetching...",e)}})()},[]),(0,s.useEffect)(()=>{var e,t;N&&N._id&&(O({fullName:N.fullName||"",_id:N._id,email:N.email||(null===(e=N.contactDetails)||void 0===e?void 0:e.email)||"",phone:N.phone||(null===(t=N.contactDetails)||void 0===t?void 0:t.primaryContact)||""}),W({fullName:N.fullName,_id:N._id}),B(""),H(!1))},[N]);const Y=(Q||[]).filter(e=>{var t;return null===(t=e.fullName)||void 0===t?void 0:t.toLowerCase().includes(X.toLowerCase())}),ee=K*z/100,te=K+Number(ee)-F;return(0,s.useEffect)(()=>{(async()=>{try{const e=await fetch("".concat("","/doctor/unique/patients"),{credentials:"include"}),t=await e.json();console.log("Patient Data:",null===t||void 0===t?void 0:t.patients),_(null===t||void 0===t?void 0:t.patients)}catch(e){console.log("Error fetching data:",e)}})()},[]),(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:"flex items-center gap-4"}),(0,m.jsxs)("div",{"data-aos":"fade-up","data-aos-duration":"1000","data-aos-delay":"100","data-aos-offset":"200",className:"my-6 rounded-xl border-[1px] border-border bg-white p-4",children:[(0,m.jsx)("div",{className:"mt-6 w-full",children:(0,m.jsxs)("div",{className:"flex w-full flex-col gap-2",children:[(0,m.jsx)("p",{className:"text-sm font-semibold text-black",children:"Patient Name"}),N?(0,m.jsx)("div",{className:"w-full",children:(0,m.jsx)("div",{className:"flex items-center border border-gray-300 rounded-lg px-3 py-2 bg-gray-50",children:(0,m.jsx)("div",{className:"flex flex-col",children:(0,m.jsx)("span",{className:"text-sm font-medium text-gray-800",children:I.fullName||(null===N||void 0===N?void 0:N.fullName)||"Unknown Patient"})})})}):(0,m.jsxs)("div",{className:"w-full relative",children:[(0,m.jsxs)("div",{className:"flex items-center border border-gray-300 rounded-lg px-3 py-2 bg-white",children:[J?(0,m.jsx)("div",{className:"w-8 h-8 rounded-md bg-gray-200 mr-2 flex items-center justify-center",children:(0,m.jsx)("span",{className:"text-xs text-gray-600 font-medium",children:(null===J||void 0===J||null===(h=J.fullName)||void 0===h||null===(f=h.charAt(0))||void 0===f?void 0:f.toUpperCase())||"P"})}):(0,m.jsx)(x.VxX,{className:"text-gray-400 mr-2",style:{fontSize:"14px"}}),(0,m.jsx)("input",{type:"text",placeholder:"Search Patient",className:"w-full border-none outline-none text-sm text-gray-600 placeholder:text-sm placeholder:text-gray-400",value:X||(null===J||void 0===J?void 0:J.fullName)||"",onChange:e=>{B(e.target.value),W(null),H(!0)}})]}),X&&Z&&(0,m.jsx)("div",{className:"absolute w-full mt-1 max-h-32 overflow-y-auto rounded-lg border border-gray-200 shadow bg-white z-10",children:0===Y.length?(0,m.jsx)("p",{className:"p-2 text-xs text-gray-500",children:"No results found"}):Y.map(e=>{var t,l,s;return(0,m.jsx)("div",{className:"cursor-pointer p-2 hover:bg-gray-100",onClick:()=>(e=>{W(e),O({fullName:e.fullName||"",_id:e._id||"",email:e.email||"",phone:e.phone||"",image:e.image||""}),H(!1),B("")})(e),children:(0,m.jsxs)("div",{className:"flex items-center gap-3",children:[(0,m.jsx)("div",{className:"w-8 h-8 rounded-md bg-gray-200 flex items-center justify-center",children:(0,m.jsx)("span",{className:"text-xs text-gray-600 font-medium",children:(null===e||void 0===e||null===(t=e.fullName)||void 0===t||null===(l=t.charAt(0))||void 0===l?void 0:l.toUpperCase())||"P"})}),(0,m.jsxs)("div",{children:[(0,m.jsx)("p",{className:"text-sm font-medium",children:e.fullName}),(0,m.jsx)("p",{className:"text-xs text-gray-500",children:e.email||(null===(s=e.contactDetails)||void 0===s?void 0:s.email)})]})]})},e._id)})})]})]})}),(0,m.jsxs)("div",{className:"mt-6 grid w-full grid-cols-6 gap-4",children:[(0,m.jsxs)("div",{className:"col-span-6 rounded-xl py-4",children:[(0,m.jsx)(o.Ss,{data:q,setData:E,servicesData:T,currency:P}),(0,m.jsxs)("button",{onClick:()=>E(e=>[...e,{_id:Date.now().toString(),serviceName:"",price:0,quantity:1}]),className:"flex-rows mt-3 w-full gap-2 rounded-lg border border-dashed border-subMain py-3 text-sm text-subMain",children:[(0,m.jsx)(r.Ca6,{})," Add Order or Service"]})]}),(0,m.jsxs)("div",{className:"col-span-6 flex flex-col gap-4",children:[(0,m.jsx)(a.l6,{selectedPerson:P,setSelectedPerson:A,datas:null===n.rQ||void 0===n.rQ?void 0:n.rQ.currency,children:(0,m.jsxs)("div",{className:"flex h-12 w-full items-center justify-between rounded-md border border-border px-3 text-xs text-main",children:[(0,m.jsx)("p",{children:P}),(0,m.jsx)(r.nwe,{className:"text-lg"})]})}),(0,m.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,m.jsxs)("div",{className:"w-full",children:[(0,m.jsx)("label",{className:"text-sm font-semibold text-black",children:"Discount"}),(0,m.jsx)("input",{type:"number",placeholder:"Enter Discount",value:F,onChange:e=>L(e.target.value),className:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 text-sm font-semibold text-black placeholder-gray-400 focus:border-blue-500 focus:outline-none"})]}),(0,m.jsxs)("div",{className:"w-full",children:[(0,m.jsx)("label",{className:"text-sm font-semibold text-black",children:"Tax(%)"}),(0,m.jsx)("input",{type:"number",placeholder:"Enter Tax Percentage",value:z,onChange:e=>G(e.target.value),className:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 text-sm font-semibold text-black placeholder-gray-400 focus:border-blue-500 focus:outline-none"})]})]}),(0,m.jsxs)("div",{className:"w-full",children:[(0,m.jsx)("label",{className:"text-sm font-semibold text-black",children:"Payment Method"}),(0,m.jsx)(a.l6,{selectedPerson:R,setSelectedPerson:V,datas:(null===n.rQ||void 0===n.rQ||null===(p=n.rQ.method)||void 0===p?void 0:p.filter(e=>"Payment method"!==e.name))||[],children:(0,m.jsxs)("div",{className:"flex h-12 w-full items-center justify-between rounded-md border border-border px-3 text-xs text-main",children:[(0,m.jsx)("p",{children:R}),(0,m.jsx)(r.nwe,{className:"text-lg"})]})})]}),(0,m.jsxs)("div",{className:"space-y-2 rounded-xl border border-border p-3",children:[(0,m.jsxs)("div",{className:"flex-btn gap-3",children:[(0,m.jsx)("p",{className:"text-xs font-extralight",children:"Sub Total:"}),(0,m.jsx)("h6",{className:"text-xs font-medium",children:K})]}),(0,m.jsxs)("div",{className:"flex-btn gap-3",children:[(0,m.jsx)("p",{className:"text-xs font-extralight",children:"Discount:"}),(0,m.jsx)("h6",{className:"text-xs font-medium",children:F})]}),(0,m.jsxs)("div",{className:"flex-btn gap-3",children:[(0,m.jsx)("p",{className:"text-xs font-extralight",children:"Tax:"}),(0,m.jsx)("h6",{className:"text-xs font-medium",children:ee})]}),(0,m.jsxs)("div",{className:"flex-btn gap-3",children:[(0,m.jsx)("p",{className:"text-xs font-extralight",children:"Grand Total:"}),(0,m.jsx)("h6",{className:"text-xs font-medium text-green-600",children:te})]})]}),(0,m.jsxs)("div",{className:"w-full",children:[(0,m.jsx)("label",{className:"text-sm font-semibold text-black",children:"Notes"}),(0,m.jsx)("textarea",{placeholder:"Thank you for your business. We hope to work with you again soon!",rows:3,value:U,onChange:e=>$(e.target.value),className:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 text-sm font-semibold text-black placeholder-gray-400 focus:border-blue-500 focus:outline-none resize-none"})]}),(0,m.jsxs)("button",{onClick:()=>{(async()=>{const e=q.map(e=>({serviceId:e._id,quantity:e.quantity||1,price:e.price,name:e.serviceName,amount:e.price*e.quantity})),t={patientId:I._id,services:e,currency:P,discount:Number(F),tax:Number(z),notes:U,startDate:y.toISOString(),endDate:w.toISOString(),amount:Number(te),method:R||"Cash"};try{const e=await fetch("".concat("","/doctor/payment/create"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)});e.ok?(await e.json(),i.oR.success("Invoice created successfully!"),b(),v()):console.error("Error ".concat(e.status,": ").concat(e.statusText))}catch(l){console.error("Network error:",l)}})()},className:"flex items-center justify-center gap-2 w-full rounded-md bg-blue-500 px-4 py-2 text-sm font-semibold text-white hover:bg-blue-600 transition-colors",children:[(0,m.jsx)(c.B07,{className:"text-sm"}),"Create Receipt"]})]})]})]})]})}}}]);