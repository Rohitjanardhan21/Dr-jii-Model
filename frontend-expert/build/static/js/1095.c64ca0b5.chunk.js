"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[1095,2078],{11827:(e,t,a)=>{a.d(t,{A:()=>n});a(9950);var s=a(35887),o=a(58549),l=a(44414);const n=function(e){let{closeModal:t,onSuccess:a}=e;return(0,l.jsx)("div",{className:"",children:(0,l.jsx)("div",{"data-aos":"fade-up","data-aos-duration":"1000","data-aos-delay":"100","data-aos-offset":"200",className:" bg-white px-6",children:(0,l.jsx)(o.A,{titles:!0,isModal:!0,onSave:async e=>{try{const t=await fetch("".concat("","/doctor/patients/create"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)}),o=await t.json();t.ok?(s.oR.success(o.message||"Patient created successfully!"),a&&a(o.data||e)):s.oR.error((null===o||void 0===o?void 0:o.message)||"Failed to create patient")}catch(t){console.error(t),s.oR.error("Something went wrong. Please try again.")}},closeModal:t})})})}},14176:(e,t,a)=>{a.d(t,{A:()=>i});var s=a(89379),o=a(9950),l=a(58644),n=a(39174),r=(a(22535),a(38613)),d=a(44414);const i=function(e){let{setOpen:t,setPatient:a,isOpen:i,patient:c,patientData:m=[]}=e;const[x,u]=(0,o.useState)(""),[h,p]=(0,o.useState)("");(0,o.useEffect)(()=>{i&&(p(""),u(""))},[i]);const g=m.filter(e=>{var t,a;const s=x.toLowerCase();var o;return c?null===(o=e.fullName)||void 0===o?void 0:o.toLowerCase().includes(s):(null===(t=e.serviceName)||void 0===t?void 0:t.toLowerCase().includes(s))||(null===(a=e.medicineName)||void 0===a?void 0:a.toLowerCase().includes(s))}),v=()=>{const e=m.find(e=>e._id===h);e&&a((0,s.A)({},e)),t(!1)};return(0,d.jsx)(l.A,{closeModal:v,isOpen:i,title:c?"Patients":"Medicine & Services",width:"max-w-xl",children:(0,d.jsxs)("div",{className:"flex-colo gap-6",children:[(0,d.jsxs)("div",{className:"flex w-full items-center gap-4 rounded-lg border border-border p-3",children:[(0,d.jsx)("input",{type:"text",placeholder:"Search",className:"w-full",value:x,onChange:e=>u(e.target.value)}),(0,d.jsx)(n.iyI,{className:"text-xl"})]}),(0,d.jsx)("div",{className:"h-[500px] w-full overflow-y-scroll",children:0===g.length?(0,d.jsx)("p",{className:"text-sm text-textGray",children:"No results found"}):(0,d.jsx)("div",{className:"space-y-2",children:g.map(e=>(0,d.jsxs)("div",{onClick:()=>p(e._id),className:"".concat(h===e._id?"border-subMain bg-subMain text-white":"border-border"," group rounded-xl border-[1px] p-4 hover:bg-subMain hover:text-white cursor-pointer"),children:[(0,d.jsx)("h6",{className:"text-sm",children:c?e.fullName:e.serviceName}),c&&(0,d.jsx)("p",{className:"".concat(h===e._id?"text-white":"text-textGray"," mt-1 text-xs group-hover:text-white"),children:e.email})]},e._id))})}),(0,d.jsx)(r.$n,{onClick:v,label:"Add",Icon:n.Ca6})]})})}},38205:(e,t,a)=>{a.d(t,{A:()=>n});var s=a(39174),o=a(28429),l=a(44414);const n=function(e){let{onActionClick:t}=e;const a={"/patients":"Add Patient","/appointments":"New Appointment","/payments":"Add Payment","/services":"Add Service"}[(0,o.zy)().pathname];return a?(0,l.jsxs)("button",{onClick:t,className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-gradient-to-r from-[#0095D9] to-[#0078B3] text-white font-medium hover:shadow-lg transform hover:scale-105 transition-all duration-200",title:a,children:[(0,l.jsx)(s.Ca6,{className:"text-lg"}),(0,l.jsx)("span",{className:"text-sm",children:a})]}):null}},74980:(e,t,a)=>{a.r(t),a.d(t,{default:()=>y});var s=a(9950),o=a(17340),l=a(38613),n=a(61533),r=a(22535),d=a(39174),i=a(31222),c=a(50384),m=a(35887),x=a(28429),u=a(58644),h=a(73719),p=a(11827),g=a(38205),v=a(44414);const y=function(){const[e,t]=(0,s.useState)(r.rQ.status[0].name),[a,y]=(0,s.useState)(r.rQ.method[0].name),[f,w]=(0,s.useState)(""),[b,j]=(0,s.useState)([]),[N,S]=(0,s.useState)(!1),[P,C]=(0,s.useState)({todayTotal:0,monthTotal:0,yearTotal:0}),[M,T]=(0,s.useState)(!1),[A,D]=(0,s.useState)(!1),[L,k]=(0,s.useState)((()=>{const e=new Date,t=new Date(e.getFullYear(),e.getMonth(),1);t.setHours(0,0,0,0);const a=new Date(e.getFullYear(),e.getMonth()+1,0);return a.setHours(23,59,59,999),[t,a]})()),[E,O]=L,F=(0,x.Zp)(),[R,_]=(0,s.useState)([]),[G,I]=(0,s.useState)(""),[Y,Q]=(0,s.useState)(!1),[z,H]=(0,s.useState)(!1),B=async()=>{try{const e=await fetch("".concat("","/doctor/patients"),{credentials:"include"}),t=await e.json();_(t||[])}catch(e){console.log("Error fetching patients:",e)}};(0,s.useEffect)(()=>{B()},[]),(0,s.useEffect)(()=>{const e=()=>{T(!0)};return window.addEventListener("action:addPayment",e),()=>{window.removeEventListener("action:addPayment",e)}},[]);const J=null===R||void 0===R?void 0:R.filter(e=>((null===e||void 0===e?void 0:e.title)||"").toLowerCase().includes(G.toLowerCase())),K=[{id:2,selected:e,setSelected:t,datas:r.rQ.status},{id:3,selected:a,setSelected:y,datas:r.rQ.method}],U=[{id:1,title:"Today Payments",value:"\u20b9".concat(P.todayTotal.toLocaleString()),color:["bg-subMain","text-subMain"],icon:d.FOv},{id:2,title:"Monthly Payments",value:"\u20b9".concat(P.monthTotal.toLocaleString()),color:["bg-orange-500","text-orange-500"],icon:c.Kh3},{id:3,title:"Yearly Payments",value:"\u20b9".concat(P.yearTotal.toLocaleString()),color:["bg-green-500","text-green-500"],icon:i.Wv5}],W=async()=>{try{S(!0);const t=new URLSearchParams;f&&t.append("patientName",f),"Status..."!==e&&t.append("status",e),"Payment method"!==a&&t.append("method",a),E&&t.append("startDate",E.toISOString()),O&&t.append("endDate",O.toISOString()),console.log("params",t);const s=await fetch("".concat("","/doctor/payments?").concat(t.toString()),{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}),o=await s.json();s.ok?j(o.data||[]):m.oR.error(o.message||"Failed to fetch data")}catch(t){console.error(t),m.oR.error("Something went wrong while fetching payments")}finally{S(!1)}};return(0,s.useEffect)(()=>{W(),(async()=>{try{const e=await fetch("".concat("","/doctor/payment-summary"),{credentials:"include"}),t=await e.json();t.success?C({todayTotal:t.todayTotal,monthTotal:t.monthTotal,yearTotal:t.yearTotal}):m.oR.error(t.message||"Failed to load summary")}catch(e){console.error("Summary Error:",e),m.oR.error("Failed to load payment summary")}})()},[]),(0,s.useEffect)(()=>{const e=setTimeout(()=>{W()},350);return()=>clearTimeout(e)},[f,e,a,E,O]),(0,v.jsxs)(o.A,{children:[(0,v.jsx)("div",{className:"relative mb-6 grid grid-cols-1 gap-2 xs:grid-cols-2 md:grid-cols-3 lg:grid-cols-7",children:(0,v.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Payments"})}),(0,v.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,v.jsx)("input",{type:"text",placeholder:'Search "Patients"',className:"h-11 rounded-md border border-border bg-dry px-4 text-sm text-main md:col-span-2 lg:col-span-3",value:G,onChange:e=>{I(e.target.value),Q(!0)},onBlur:()=>{setTimeout(()=>Q(!1),150)},onFocus:()=>Q(!0)}),Y&&G&&(0,v.jsxs)("ul",{className:"absolute top-16 z-10 w-full max-w-xs rounded-md border border-gray-200 bg-white shadow-md md:col-span-2 lg:col-span-3",children:[(null===J||void 0===J?void 0:J.length)>0&&J.map((e,t)=>(0,v.jsxs)("li",{className:"flex cursor-pointer flex-row items-center gap-3 px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onMouseDown:t=>{t.preventDefault(),I((null===e||void 0===e?void 0:e.title)||""),Q(!1),F("/patients/preview/".concat(null===e||void 0===e?void 0:e._id))},children:[(0,v.jsx)("img",{src:null===e||void 0===e?void 0:e.image,alt:"Patient",className:"h-10 w-10 rounded-full border border-subMain object-cover"}),(0,v.jsxs)("div",{className:"flex flex-col",children:[(0,v.jsx)("h2",{className:"text-sm font-semibold",children:null===e||void 0===e?void 0:e.title}),(0,v.jsx)("p",{className:"text-xs text-textGray",children:null===e||void 0===e?void 0:e.email}),(0,v.jsx)("p",{className:"text-xs",children:null===e||void 0===e?void 0:e.phone})]})]},t)),0===(null===J||void 0===J?void 0:J.length)&&(0,v.jsxs)("li",{className:"flex cursor-pointer items-center gap-2 px-4 py-2 text-sm text-main hover:bg-gray-100",onMouseDown:e=>{e.preventDefault(),H(!0)},children:[(0,v.jsx)("span",{className:"text-xl font-bold",children:"+"}),(0,v.jsxs)("span",{children:['Add "',G,'" as new patient']})]})]}),(0,v.jsx)(g.A,{onActionClick:()=>T(!0)})]}),(0,v.jsx)("div",{className:"mt-8 grid grid-cols-1 gap-8 sm:grid-cols-2 lg:grid-cols-3",children:U.map(e=>(0,v.jsxs)("div",{className:"flex-btn gap-4 rounded-xl border-[1px] border-border bg-white p-4",children:[(0,v.jsxs)("div",{className:"w-3/4",children:[(0,v.jsx)("h2",{className:"text-sm font-medium",children:e.title}),(0,v.jsx)("h2",{className:"my-3 text-xl font-medium",children:e.value}),(0,v.jsxs)("p",{className:"text-xs text-textGray",children:["You made ",(0,v.jsx)("span",{className:e.color[1],children:e.value})," ","transactions"," ","Today Payments"===e.title?"today":"Monthly Payments"===e.title?"this month":"this year"]})]}),(0,v.jsx)("div",{className:"flex-colo text-md h-10 w-10 rounded-md text-white ".concat(e.color[0]),children:(0,v.jsx)(e.icon,{})})]},e.id))}),(0,v.jsxs)("div",{className:"my-8 rounded-xl border-[1px] border-border bg-white p-5",children:[(0,v.jsxs)("div",{className:"grid grid-cols-1 gap-2 xs:grid-cols-2 md:grid-cols-3 lg:grid-cols-4",children:[(0,v.jsx)("input",{type:"text",placeholder:'Search "Patients"',className:"flex h-14 w-full items-center justify-between rounded-md border border-border bg-dry px-4 text-xs text-main",value:f,onChange:e=>w(e.target.value)}),K.map(e=>(0,v.jsx)(l.l6,{selectedPerson:e.selected,setSelectedPerson:t=>e.setSelected(t),datas:e.datas,children:(0,v.jsxs)("div",{className:"mt-[4px] flex h-14 w-full items-center justify-between rounded-md border border-border bg-dry px-4 text-xs text-main",children:[(0,v.jsx)("p",{children:e.selected}),(0,v.jsx)(d.nwe,{className:"text-xl"})]})},e.id)),(0,v.jsx)(l.Yf,{className:"flex h-14 w-full items-center justify-between rounded-md border border-border bg-dry px-4 text-xs text-main",startDate:E,endDate:O,bg:"bg-dry",onChange:e=>k(e)})]}),(0,v.jsx)("div",{className:"mt-8 w-full overflow-x-scroll",children:(0,v.jsx)(n.zH,{data:b,loading:N,functions:{edit:e=>{F("/payments/edit/".concat(e))},preview:e=>{F("/payments/preview/".concat(e))}}})})]}),M&&(0,v.jsx)(u.A,{isOpen:M,closeModal:()=>T(!1),title:"Create Invoice",width:"max-w-6xl",children:(0,v.jsx)("div",{className:"max-h-[80vh] overflow-y-auto",children:(0,v.jsx)(h.default,{closeModal:()=>{T(!1),W(),D(!1)},onSuccess:()=>D(!0)})})}),(0,v.jsx)(u.A,{isOpen:z,closeModal:()=>H(!1),title:"Add New Patient",children:(0,v.jsx)(p.A,{closeModal:()=>H(!1),onSuccess:e=>{B(),I(""),H(!1)}})})]})}}}]);